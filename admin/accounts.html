<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Accounts - v2.0</title>
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/accounts.css">
    <link rel="stylesheet" href="../css/sidebar.css">
    <style>
        /* Modal override - side panel matching marketplace style */
        #accountModal.modal {
            position: fixed;
            right: -50%;
            top: 0;
            width: 50%;
            height: 100vh;
            background: white;
            box-shadow: -4px 0 20px rgba(0,0,0,0.15);
            transition: right 0.3s ease;
            overflow-y: auto;
            z-index: 1000;
        }
        
        #accountModal.modal.active {
            right: 0;
        }
        
        /* Modal spacing improvements - marketplace style */
        #accountModal .modal-content {
            padding: 0 !important;
        }
        
        #accountModal .modal-header {
            padding: 24px;
            border-bottom: 1px solid #e5e5e5;
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
            margin-bottom: 0 !important;
        }
        
        #accountModal .modal-header h2 {
            font-size: 20px !important;
            color: #1a1a1a !important;
            font-weight: 600 !important;
        }
        
        #accountModal .close-btn {
            background: none;
            border: none;
            font-size: 24px !important;
            cursor: pointer;
            color: #666;
            padding: 4px 8px;
            line-height: 1;
        }
        
        #accountModal .close-btn:hover {
            color: #1a1a1a;
        }
        
        /* Tab content padding */
        .account-tab-content {
            padding: 24px;
        }
        
        /* Form groups - marketplace style */
        #accountModal .field-group {
            margin-bottom: 0;
        }
        
        #accountModal .field-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #333;
            margin-bottom: 6px;
        }
        
        #accountModal .field-group input,
        #accountModal .field-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        
        #accountModal .field-group input:focus,
        #accountModal .field-group select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        #accountModal .account-tab-content > div:first-child {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }
        
        /* Save button - marketplace style */
        #accountModal .modal-content > div:last-child {
            display: flex;
            gap: 12px;
            padding: 20px 24px;
            border-top: 1px solid #e5e5e5;
            position: sticky;
            bottom: 0;
            background: white;
            margin-top: 0 !important;
        }
        
        #accountModal .modal-content > div:last-child .btn {
            flex: 1;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        /* Profile tab hover and active states */
        .profile-tab {
            transition: all 0.3s ease;
        }
        
        .profile-tab:hover {
            background: #e3f2fd !important;
            border-color: #3498db !important;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
        }
        
        .profile-tab.active {
            background: #3498db !important;
            color: white !important;
            border-color: #3498db !important;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .profile-tab.active:hover {
            background: #2980b9 !important;
            transform: translateY(-2px);
        }
        
        /* Profile tabs container styling - marketplace style */
        .profile-tabs {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .profile-tab {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 13px;
        }
        
        .profile-tab-add {
            padding: 8px 16px !important;
            font-size: 13px !important;
            border: 1px dashed #3498db !important;
            background: white !important;
            color: #3498db !important;
            border-radius: 6px !important;
            cursor: pointer !important;
            font-weight: 500 !important;
            transition: all 0.2s;
        }
        
        .profile-tab-add:hover {
            background: #e3f2fd !important;
            border-style: solid !important;
        }
        
        /* Profile content styling - marketplace style */
        .profile-content {
            background: #fafafa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e5e5e5;
            margin-top: 16px;
        }
        
        .profile-content .field-group input,
        .profile-content .field-group select {
            background: white;
        }
        
        .profile-custom-fields {
            background: #fff9e6 !important;
            border: 1px dashed #ffc107 !important;
            border-radius: 8px !important;
            padding: 16px !important;
            margin-top: 16px !important;
        }
        
        .profile-custom-fields h4 {
            color: #f57c00 !important;
            font-weight: 600 !important;
            font-size: 14px !important;
            margin-bottom: 12px !important;
        }
        
        .custom-field-item {
            background: white;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 8px !important;
            display: flex;
            gap: 8px;
        }
        
        .custom-field-item input {
            flex: 1;
            padding: 8px 12px !important;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 13px;
        }
        
        .custom-field-item .btn {
            padding: 8px 16px !important;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            white-space: nowrap;
        }
        
        .custom-field-item .btn:hover {
            background: #c0392b;
        }
        
        .profile-custom-fields > .btn {
            padding: 8px 16px !important;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-top: 8px;
        }
        
        .profile-custom-fields > .btn:hover {
            background: #2980b9;
        }
        
        /* Profiles table styling */
        .profiles-table {
            width: 100% !important;
            border-collapse: collapse !important;
            background: white !important;
            border-radius: 8px !important;
            overflow: hidden !important;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
        }
        
        .profiles-table thead tr {
            background: #2c3e50 !important;
            color: white !important;
        }
        
        .profiles-table thead th {
            text-align: left !important;
            padding: 14px 16px !important;
            font-size: 0.85rem !important;
            font-weight: 600 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.5px !important;
            color: white !important;
            background: #2c3e50 !important;
        }
        
        .profiles-table tbody tr {
            border-bottom: 1px solid #e5e5e5 !important;
        }
        
        .profiles-table tbody td {
            padding: 16px !important;
        }
        
        /* 2FA Code styling */
        .code-2fa:hover {
            background: #e3f2fd !important;
            transform: scale(1.05);
        }
        
        .code-2fa:active {
            transform: scale(0.95);
        }
        
        /* Visibility toggle styling */
        .visibility-toggle:hover {
            transform: scale(1.2);
        }
        
        .visibility-toggle:active {
            transform: scale(0.9);
        }
        
        /* Cards section - realistic credit card style */
        #cardsList {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .card-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .card-item::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }
        
        .card-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.2);
        }
        
        .card-item .card-chip {
            width: 50px;
            height: 40px;
            background: linear-gradient(135deg, #f4d03f 0%, #e6b800 100%);
            border-radius: 8px;
            margin-bottom: 20px;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .card-item .card-chip::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: 8px;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 4px;
        }
        
        .card-item .card-number {
            font-size: 22px;
            letter-spacing: 3px;
            font-family: 'Courier New', monospace;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .card-item .card-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        
        .card-item .card-holder {
            flex: 1;
        }
        
        .card-item .card-label {
            font-size: 10px;
            text-transform: uppercase;
            opacity: 0.8;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .card-item .card-value {
            font-size: 14px;
            font-weight: 500;
        }
        
        .card-item .card-type {
            text-align: right;
            font-size: 18px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .card-item .card-actions {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255,255,255,0.2);
            display: flex;
            gap: 12px;
        }
        
        .card-item .btn {
            flex: 1;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            backdrop-filter: blur(10px);
            transition: all 0.2s;
        }
        
        .card-item .btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }
        
        .card-item .btn.btn-danger {
            background: rgba(231, 76, 60, 0.3);
            border-color: rgba(231, 76, 60, 0.5);
        }
        
        .card-item .btn.btn-danger:hover {
            background: rgba(231, 76, 60, 0.5);
        }
        
        /* Card color variations */
        .card-item:nth-child(1) {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-item:nth-child(2) {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .card-item:nth-child(3) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .card-item:nth-child(4) {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .card-item:nth-child(5) {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        #tabCards > .btn {
            margin-top: 16px;
            padding: 12px 24px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        #tabCards > .btn:hover {
            background: #2980b9;
        }
        
        /* More Filters Dropdown */
        .more-filters-wrapper {
            position: relative;
        }
        
        .more-filters-btn {
            background: white;
            color: #3498db;
            border: 1px solid #3498db;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.2rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .more-filters-btn:hover {
            background: #e3f2fd;
        }
        
        .more-filters-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            padding: 20px;
            min-width: 320px;
            z-index: 1000;
            display: none;
        }
        
        .more-filters-dropdown.active {
            display: block;
        }
        
        .more-filters-dropdown .field-group {
            margin-bottom: 16px;
        }
        
        .more-filters-dropdown .field-group:last-of-type {
            margin-bottom: 20px;
        }
        
        .more-filters-dropdown .field-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #333;
            margin-bottom: 6px;
        }
        
        .more-filters-dropdown .field-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .dropdown-actions {
            display: flex;
            gap: 8px;
            padding-top: 12px;
            border-top: 1px solid #e5e5e5;
        }
        
        .dropdown-actions .btn {
            flex: 1;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .dropdown-actions .apply-btn {
            background: #3498db;
            color: white;
        }
        
        .dropdown-actions .apply-btn:hover {
            background: #2980b9;
        }
        
        .dropdown-actions .clear-btn {
            background: #95a5a6;
            color: white;
        }
        
        .dropdown-actions .clear-btn:hover {
            background: #7f8c8d;
        }

        /* Responsive table wrapper */
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .table-wrapper table {
            min-width: 1400px;
            margin: 0;
        }

        /* Prevent horizontal scroll on body */
        body {
            overflow-x: hidden;
        }

        .main {
            overflow-x: hidden;
        }

        /* Responsive adjustments */
        @media (max-width: 1400px) {
            .filters {
                flex-wrap: wrap;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .stat-box h4 {
                font-size: 0.65rem;
            }

            .stat-value {
                font-size: 1.3rem;
            }

            .stat-box {
                padding: 1rem;
            }

            /* Make table more compact */
            table {
                font-size: 0.85rem;
            }

            table th,
            table td {
                padding: 0.6rem 0.5rem;
            }

            .btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 1024px) {
            .stat-box h4 {
                font-size: 0.6rem;
            }

            .stat-value {
                font-size: 1.1rem;
            }

            .stat-box {
                padding: 0.8rem;
            }

            .header-right {
                flex-direction: column;
                gap: 0.5rem;
            }

            /* Make table even more compact */
            table {
                font-size: 0.8rem;
            }

            table th,
            table td {
                padding: 0.5rem 0.4rem;
            }

            .btn {
                padding: 0.35rem 0.7rem;
                font-size: 0.75rem;
            }

            .badge {
                font-size: 0.7rem;
                padding: 0.2rem 0.5rem;
            }
        }

        /* Status dropdown styling */
        .status-dropdown {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 12px;
            padding-right: 1.5rem !important;
        }

        .status-dropdown option {
            background: white !important;
            color: #333 !important;
            padding: 0.5rem;
        }

        /* Profile status dropdown styling */
        .profile-status-dropdown {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 12px;
            padding-right: 1.5rem !important;
        }

        .profile-status-dropdown option {
            background: white !important;
            color: #333 !important;
            padding: 0.5rem;
        }

        @media (max-width: 768px) {
            .statistics {
                grid-template-columns: 1fr;
            }

            .filters {
                flex-direction: column;
                align-items: stretch !important;
            }

            .filters input,
            .filters select {
                width: 100% !important;
            }

            .more-filters-wrapper {
                width: 100%;
            }

            .more-filters-btn {
                width: 100%;
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .header-right {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <div class="layout">
        <header class="header">
            <h1>Accounts</h1>
            <div class="header-right">
                <div class="theme-toggle">
                    <button class="theme-btn active">Light</button>
                    <button class="theme-btn">Dark</button>
                </div>
                <div class="user-info">
                    <span>Admin User</span>
                    <div class="user-avatar">AU</div>
                </div>
            </div>
        </header>
        
        <!-- Dynamic Sidebar (generated by sidebar.js) -->
        <aside class="sidebar" id="sidebar"></aside>
        
        <main class="main">
            <div class="statistics">
                <div class="stat-box">
                    <h4>PLATFORM VAULT</h4>
                    <div class="stat-value">$12,450.00</div>
                    <div class="stat-description">Total platform reserves</div>
                </div>
                <div class="stat-box">
                    <h4>GENERAL WALLET BALANCE</h4>
                    <div class="stat-value">$783.04</div>
                    <div class="stat-description">This is "Remaining balance"</div>
                </div>
                <div class="stat-box">
                    <h4>INDIVIDUAL BALANCES TOTAL</h4>
                    <div class="stat-value">$1,080.00</div>
                    <div class="stat-description">Sum of per-account balances</div>
                </div>
                <div class="stat-box">
                    <h4>ACCOUNTS</h4>
                    <div class="stat-value">8</div>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-top: 12px;">
                        <div style="text-align: center;">
                            <div style="font-size: 20px; font-weight: 600; color: #3498db;">5</div>
                            <div style="font-size: 11px; color: #666; margin-top: 2px;">Assigned</div>
                        </div>
                        <div style="width: 1.5px; height: 35px; background: #e0e0e0;"></div>
                        <div style="text-align: center;">
                            <div style="font-size: 20px; font-weight: 600; color: #e67700;">3</div>
                            <div style="font-size: 11px; color: #666; margin-top: 2px;">Unassigned</div>
                        </div>
                        <div style="width: 1.5px; height: 35px; background: #e0e0e0;"></div>
                        <div style="text-align: center;">
                            <div style="font-size: 20px; font-weight: 600; color: #27ae60;">5</div>
                            <div style="font-size: 11px; color: #666; margin-top: 2px;">Active</div>
                        </div>
                        <div style="width: 1.5px; height: 35px; background: #e0e0e0;"></div>
                        <div style="text-align: center;">
                            <div style="font-size: 20px; font-weight: 600; color: #e74c3c;">1</div>
                            <div style="font-size: 11px; color: #666; margin-top: 2px;">Restricted</div>
                        </div>
                    </div>
                </div>
                <div class="stat-box">
                    <h4>SPEND (PERIOD)</h4>
                    <div class="stat-value">$4,776.96</div>
                    <div class="stat-description">Includes manual spend for CL</div>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div class="filters" style="margin-bottom: 0; flex: 1; display: flex; gap: 0.5rem; align-items: center;">
                <input type="text" id="searchInput" placeholder="Search accounts...">
                <select id="platformFilter">
                    <option value="">All Platforms</option>
                    <option value="facebook">Facebook</option>
                    <option value="google">Google</option>
                    <option value="taboola">Taboola</option>
                    <option value="outbrain">Outbrain</option>
                    <option value="microsoft">Microsoft</option>
                    <option value="tiktok">TikTok</option>
                    <option value="snapchat">Snapchat</option>
                </select>
                <select id="statusFilter">
                    <option value="">All Status</option>
                    <option value="active">Active</option>
                    <option value="restricted">Restricted</option>
                    <option value="in-review">In Review</option>
                    <option value="disabled">Disabled</option>
                </select>
                <select id="assignedFilter" style="max-height: 200px;">
                    <option value="assigned" selected>Assigned</option>
                    <option value="unassigned">Unassigned</option>
                    <option value="client-a">Client A</option>
                    <option value="client-b">Client B</option>
                    <option value="client-c">Client C</option>
                </select>
                <div class="more-filters-wrapper">
                    <button class="btn more-filters-btn" onclick="toggleMoreFilters(event)">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                        </svg>
                        More Filters
                    </button>
                    <div class="more-filters-dropdown" id="moreFiltersDropdown">
                        <div class="field-group">
                            <label>Tag</label>
                            <select id="tagFilter">
                                <option value="">All Tags</option>
                                <option value="scaling-01">Scaling 01</option>
                                <option value="brand-x">Brand X</option>
                                <option value="testing">Testing</option>
                                <option value="premium">Premium</option>
                                <option value="launch">Launch</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Asset Type</label>
                            <select id="assetTypeFilter">
                                <option value="">All Asset Types</option>
                                <option value="ad-account">Ad Account</option>
                                <option value="profile">Profile</option>
                                <option value="bm">BM</option>
                                <option value="page">Page</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Balance Type</label>
                            <select id="balanceTypeFilter">
                                <option value="">All Balance Types</option>
                                <option value="general">General</option>
                                <option value="individual">Individual</option>
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Contract Type</label>
                            <select id="contractFilter">
                                <option value="">All Contracts</option>
                                <option value="recurring">Recurring</option>
                                <option value="one-time">One Time</option>
                            </select>
                        </div>
                        <div class="dropdown-actions">
                            <button class="btn apply-btn" onclick="applyMoreFilters()">Apply</button>
                            <button class="btn clear-btn" onclick="clearMoreFilters()">Clear</button>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="clearAllFilters()" style="background: white; color: #95a5a6; border: 1px solid #95a5a6; display: flex; align-items: center; gap: 0.5rem; padding: 0.6rem 1.2rem; font-weight: 500;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                    Clear
                </button>
                </div>
                <button class="btn" onclick="openAddAccountModal()" style="margin-left: 1rem;">+ Add Account</button>
                <button class="btn" id="deleteSelectedBtn" onclick="deleteSelectedAccounts()" style="margin-left: 0.5rem; background: #e74c3c; color: white; display: none;">
                    üóëÔ∏è Delete Selected (<span id="selectedCount">0</span>)
                </button>
            </div>

            <div class="table-wrapper" style="overflow-x: auto; -webkit-overflow-scrolling: touch;">
            <table>
                <thead>
                    <tr>
                        <th style="width: 40px;"><input type="checkbox" id="selectAllAccounts" onchange="toggleSelectAll(this)"></th>
                        <th>ID</th>
                        <th>Platform</th>
                        <th>Asset</th>
                        <th>Account Name</th>
                        <th>Status</th>
                        <th>Pay</th>
                        <th>Contract</th>
                        <th>Tag</th>
                        <th>Balance Type</th>
                        <th>Balance</th>
                        <th>Access</th>
                        <th>Spend</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="accountsTable">
                    <tr data-platform="facebook" data-status="active" data-assigned="client-a" data-asset="ad-account" data-balance="general" data-contract="recurring" data-tag="scaling-01" data-account-id="1">
                        <td><input type="checkbox" class="account-checkbox" value="1"></td>
                        <td>1</td>
                        <td>Facebook</td>
                        <td>Ad Account</td>
                        <td>
                            <div style="font-weight: 600;">Dennis Robertson</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Skyblue Media - FB-7832</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="1" onchange="updateAccountStatus(1, this.value)" style="background: #d4f4dd; color: #0d7a2c; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active" selected>‚óè Active</option>
                                <option value="in-review">‚óè In Review</option>
                                <option value="restricted">‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CL</td>
                        <td>Recurring</td>
                        <td>Scaling 01</td>
                        <td>General</td>
                        <td>Shared wallet</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-1">Main Profile</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(1)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$134.96</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(1)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(1)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr data-platform="google" data-status="in-review" data-assigned="client-b" data-asset="ad-account" data-balance="individual" data-contract="recurring" data-tag="brand-x">
                        <td>2</td>
                        <td>Google</td>
                        <td>Ad Account</td>
                        <td>
                            <div style="font-weight: 600;">Ada Account Pro</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Client B - GG-67890</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="2" onchange="updateAccountStatus(2, this.value)" style="background: #fff4e6; color: #e67700; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active">‚óè Active</option>
                                <option value="in-review" selected>‚óè In Review</option>
                                <option value="restricted">‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CL</td>
                        <td>Recurring</td>
                        <td>Brand X</td>
                        <td>Individual</td>
                        <td style="font-weight: 600;">$1,080.00</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-2">Gmail Main</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(2)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$892.00</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(2)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(2)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr data-platform="tiktok" data-status="active" data-assigned="client-a" data-asset="ad-account" data-balance="general" data-contract="one-time" data-tag="testing">
                        <td>3</td>
                        <td>TikTok</td>
                        <td>Ad Account</td>
                        <td>
                            <div style="font-weight: 600;">TikTok Campaign</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Client A - TT-45678</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="3" onchange="updateAccountStatus(3, this.value)" style="background: #d4f4dd; color: #0d7a2c; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active" selected>‚óè Active</option>
                                <option value="in-review">‚óè In Review</option>
                                <option value="restricted">‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CC</td>
                        <td>One Time</td>
                        <td>Testing</td>
                        <td>General</td>
                        <td>Shared wallet</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-3">TikTok Pro</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(3)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$3,200.00</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(3)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(3)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr data-platform="taboola" data-status="active" data-assigned="client-c" data-asset="profile" data-balance="individual" data-contract="recurring" data-tag="premium">
                        <td>4</td>
                        <td>Taboola</td>
                        <td>Profile</td>
                        <td>
                            <div style="font-weight: 600;">Native Ads Pro</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Client C - TB-98765</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="4" onchange="updateAccountStatus(4, this.value)" style="background: #d4f4dd; color: #0d7a2c; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active" selected>‚óè Active</option>
                                <option value="in-review">‚óè In Review</option>
                                <option value="restricted">‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CL</td>
                        <td>Recurring</td>
                        <td>Premium</td>
                        <td>Individual</td>
                        <td style="font-weight: 600;">$5,900.00</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-4">Taboola Master</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(4)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$2,100.00</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(4)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(4)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr data-platform="snapchat" data-status="restricted" data-assigned="client-b" data-asset="ad-account" data-balance="general" data-contract="one-time" data-tag="launch">
                        <td>5</td>
                        <td>Snapchat</td>
                        <td>Ad Account</td>
                        <td>
                            <div style="font-weight: 600;">Snap Ads Elite</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Client B - SC-11223</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="5" onchange="updateAccountStatus(5, this.value)" style="background: #ffebee; color: #c62828; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active">‚óè Active</option>
                                <option value="in-review">‚óè In Review</option>
                                <option value="restricted" selected>‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CC</td>
                        <td>One Time</td>
                        <td>Launch</td>
                        <td>General</td>
                        <td>Shared wallet</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-5">Snap Main</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(5)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$1,450.00</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(5)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(5)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr data-platform="facebook" data-status="active" data-assigned="unassigned" data-asset="ad-account" data-balance="general" data-contract="-" data-tag="">
                        <td>6</td>
                        <td>Facebook</td>
                        <td>Ad Account</td>
                        <td>
                            <div style="font-weight: 600;">FB Premium Account</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Unassigned - FB-9988</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="6" onchange="updateAccountStatus(6, this.value)" style="background: #d4f4dd; color: #0d7a2c; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active" selected>‚óè Active</option>
                                <option value="in-review">‚óè In Review</option>
                                <option value="restricted">‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CL</td>
                        <td>-</td>
                        <td>-</td>
                        <td>General</td>
                        <td>Shared wallet</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-6">FB Premium</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(6)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$0.00</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(6)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(6)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr data-platform="google" data-status="active" data-assigned="unassigned" data-asset="ad-account" data-balance="individual" data-contract="-" data-tag="">
                        <td>7</td>
                        <td>Google</td>
                        <td>Ad Account</td>
                        <td>
                            <div style="font-weight: 600;">Google Ads Fresh</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Unassigned - GG-5544</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="7" onchange="updateAccountStatus(7, this.value)" style="background: #d4f4dd; color: #0d7a2c; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active" selected>‚óè Active</option>
                                <option value="in-review">‚óè In Review</option>
                                <option value="restricted">‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CC</td>
                        <td>-</td>
                        <td>-</td>
                        <td>Individual</td>
                        <td style="font-weight: 600;">$0.00</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-7">Google Fresh</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(7)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$0.00</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(7)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(7)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr data-platform="tiktok" data-status="in-review" data-assigned="unassigned" data-asset="profile" data-balance="general" data-contract="-" data-tag="">
                        <td>8</td>
                        <td>TikTok</td>
                        <td>Profile</td>
                        <td>
                            <div style="font-weight: 600;">TikTok New Profile</div>
                            <div style="font-size: 0.85rem; color: #7f8c8d;">Unassigned - TT-7766</div>
                        </td>
                        <td>
                            <select class="status-dropdown" data-account-id="8" onchange="updateAccountStatus(8, this.value)" style="background: #fff4e6; color: #e67700; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active">‚óè Active</option>
                                <option value="in-review" selected>‚óè In Review</option>
                                <option value="restricted">‚óè Restricted</option>
                                <option value="disabled">‚óè Disabled</option>
                            </select>
                        </td>
                        <td>CL</td>
                        <td>-</td>
                        <td>-</td>
                        <td>General</td>
                        <td>Shared wallet</td>
                        <td>
                            <div style="font-weight: 600;">
                                Main: <span id="access-8">TikTok New</span>
                                <div>
                                    <a href="javascript:void(0)" onclick="showLoginDetails(8)" style="font-size: 0.75rem; color: #3498db; text-decoration: none; font-weight: 400;">log details</a>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: 600;">$0.00</td>
                        <td>
                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                <button class="icon-btn" onclick="openNotesModal(8)" title="View and edit notes">
                                    üìù
                                </button>
                                <button class="icon-btn" onclick="openModal(8)" title="View account details">
                                    üëÅÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            </div>
        </main>
    </div>

    <div class="overlay" id="overlay" onclick="closeModal()"></div>
    <div class="overlay" id="notesOverlay" onclick="closeNotesModal()"></div>
    <div class="overlay" id="addAccountOverlay" onclick="closeAddAccountModal()"></div>
    <div class="overlay" id="addProfileOverlay" onclick="closeAddProfileModal()"></div>
    <div class="overlay" id="confirmOverlay"></div>
    <div class="overlay" id="deleteAccountsOverlay" onclick="closeDeleteModal()"></div>
    
    <div class="modal" id="accountModal">
        <div class="modal-content" style="padding: 2.5rem;">
            <div class="modal-header" style="margin-bottom: 2rem;">
                <div>
                    <h2 style="font-size: 1.5rem; font-weight: 600; margin: 0;">Account Details</h2>
                    <p id="modalHeaderAccountName" style="font-size: 1.1rem; color: #2c3e50; margin: 0.5rem 0 0 0; font-weight: 600;">Campaign Account 1</p>
                </div>
                <button class="close-btn" onclick="closeModal()" style="font-size: 1.5rem;">&times;</button>
            </div>

            <!-- Tabs Navigation -->
            <div style="display: flex; gap: 0; border-bottom: 2px solid #e5e5e5; margin-bottom: 2rem;">
                <button class="account-tab active" onclick="switchAccountTab('profiles')" data-tab="profiles" style="flex: 1; padding: 1rem; border: none; background: none; font-size: 0.95rem; font-weight: 600; color: #666; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                    Profiles
                </button>
                <button class="account-tab" onclick="switchAccountTab('details')" data-tab="details" style="flex: 1; padding: 1rem; border: none; background: none; font-size: 0.95rem; font-weight: 600; color: #666; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                    Details
                </button>
                <button class="account-tab" onclick="switchAccountTab('cards')" data-tab="cards" style="flex: 1; padding: 1rem; border: none; background: none; font-size: 0.95rem; font-weight: 600; color: #666; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;">
                    Cards
                </button>
            </div>

            <!-- Tab Content: Account Details -->
            <div class="account-tab-content active" id="tabDetails">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2.5rem; row-gap: 2rem;">
                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.75rem; font-weight: 500; color: #2c3e50; font-size: 0.95rem;">ID</label>
                        <input type="text" id="modalTableId" value="1" readonly style="width: 100%; padding: 0.875rem; border: 1px solid #ddd; border-radius: 8px; background: #f5f5f5; font-size: 0.95rem;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.75rem; font-weight: 500; color: #2c3e50; font-size: 0.95rem;">Account ID</label>
                        <input type="text" id="modalAccountId" value="FB-12345" readonly style="width: 100%; padding: 0.875rem; border: 1px solid #ddd; border-radius: 8px; background: #f5f5f5; font-size: 0.95rem;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.75rem; font-weight: 500; color: #2c3e50; font-size: 0.95rem;">Account Name</label>
                        <input type="text" id="modalAccountName" value="Campaign Account 1" style="width: 100%; padding: 0.875rem; border: 1px solid #ddd; border-radius: 8px; font-size: 0.95rem;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Platform</label>
                        <input type="text" id="modalPlatform" value="Facebook" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Client</label>
                        <input type="text" id="modalClient" value="Client A" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Client Tag</label>
                        <input type="text" id="modalClientTag" value="Premium" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Asset Type</label>
                        <select id="modalAssetType" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="ad-account">Ad Account</option>
                            <option value="profile">Profile</option>
                            <option value="bm">BM</option>
                            <option value="page">Page</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Status</label>
                        <select id="modalStatus" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="active">Active</option>
                            <option value="in-review">In Review</option>
                            <option value="restricted">Restricted</option>
                            <option value="disabled">Disabled</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Balance Type</label>
                        <select id="modalBalanceType" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="general">General</option>
                            <option value="individual">Individual</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Balance</label>
                        <input type="text" id="modalBalance" value="$2,580.00" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Primary Access</label>
                        <input type="text" id="modalPrimaryAccess" value="Main Profile" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Account Type</label>
                        <select id="modalAccountType" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="cc">CC (Credit Card)</option>
                            <option value="cl">CL (Credit Line)</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Billing</label>
                        <select id="modalBilling" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="one-time">One Time</option>
                            <option value="recurring">Recurring</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Provider</label>
                        <input type="text" id="modalProvider" value="Adi" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>
                </div>
            </div>

           <div class="account-tab-content" id="tabProfiles" style="display:none;">
    <div class="profiles-layout">

        <!-- ================= PROFILE LIST ================= -->
        <div class="profiles-list-box">
            <div class="profiles-list-header">
                <h3>Profile List</h3>
                <button class="btn btn-primary" onclick="addProfile()">+ Add Profile</button>
            </div>

            <table class="profiles-table">
                <thead>
                    <tr>
                        <th>Profile Name</th>
                        <th>Email</th>
                        <th class="center">Tag</th>
                        <th class="center">Status</th>
                        <th class="center">Visibility</th>
                        <th class="center">Active</th>
                    </tr>
                </thead>
                <tbody id="profilesList">
                    <tr data-profile="1">
                        <td class="strong">
                            Main Profile
                            <span class="code-2fa" onclick="copy2FACode(this)" style="margin-left: 8px; padding: 4px 8px; background: #f0f0f0; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 12px; cursor: pointer; color: #3498db; font-weight: 600; transition: all 0.2s;" title="Click to copy">
                                123456
                            </span>
                        </td>
                        <td>main.profile@example.com</td>
                        <td class="center">
                            <span class="tag tag-primary">Primary</span>
                        </td>
                        <td class="center">
                            <select class="profile-status-dropdown" style="background: #d4f4dd; color: #0d7a2c; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active" selected>‚óè Active</option>
                                <option value="suspended">‚óè Suspended</option>
                            </select>
                        </td>
                        <td class="center">
                            <span class="visibility-toggle" onclick="toggleVisibility(this)" style="cursor: pointer; font-size: 20px; transition: all 0.2s;" data-visible="true" title="Click to toggle visibility">
                                üëÅÔ∏è
                            </span>
                        </td>
                        <td class="center">
                            <input type="radio" name="activeProfile" checked onchange="switchToProfile(1, false, event)">
                        </td>
                    </tr>

                    <tr data-profile="2">
                        <td class="strong">
                            Backup Profile
                            <span class="code-2fa" onclick="copy2FACode(this)" style="margin-left: 8px; padding: 4px 8px; background: #f0f0f0; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 12px; cursor: pointer; color: #3498db; font-weight: 600; transition: all 0.2s;" title="Click to copy">
                                789012
                            </span>
                        </td>
                        <td>backup.profile@example.com</td>
                        <td class="center">
                            <span class="tag tag-backup">Backup</span>
                        </td>
                        <td class="center">
                            <select class="profile-status-dropdown" style="background: #d4f4dd; color: #0d7a2c; border: none; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.85rem; font-weight: 500; cursor: pointer;">
                                <option value="active" selected>‚óè Active</option>
                                <option value="suspended">‚óè Suspended</option>
                            </select>
                        </td>
                        <td class="center">
                            <span class="visibility-toggle" onclick="toggleVisibility(this)" style="cursor: pointer; font-size: 20px; transition: all 0.2s;" data-visible="true" title="Click to toggle visibility">
                                üëÅÔ∏è
                            </span>
                        </td>
                        <td class="center">
                            <input type="radio" name="activeProfile" onchange="switchToProfile(2, false, event)">
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ================= ACTIVE PROFILE DETAILS ================= -->
        <div class="profile-details-box">

            <h3>Active Profile Details</h3>

            <!-- PROFILE 1 -->
            <div class="profile-details-content" id="profileDetails1">

                <div class="field-group-grid">
                    <div class="field-group">
                        <label>Profile Name</label>
                        <input type="text" value="Main Profile">
                    </div>

                    <div class="field-group">
                        <label>Email</label>
                        <input type="email" value="main.profile@example.com">
                    </div>

                    <div class="field-group">
                        <label>Password</label>
                        <input type="password" value="********">
                    </div>

                    <div class="field-group">
                        <label>2FA Code</label>
                        <input type="text" value="JBSWY3DPEHPK3PXP">
                    </div>

                    <div class="field-group">
                        <label>Recovery Email</label>
                        <input type="email" value="recovery.main@example.com">
                    </div>

                    <div class="field-group">
                        <label>Recovery Email Password</label>
                        <input type="password" value="********">
                    </div>
                </div>

                <!-- CUSTOM FIELDS -->
                <div class="profile-custom-fields">
                    <h4>Custom Fields</h4>

                    <div class="custom-field-item">
                        <input type="text" value="Recovery Email">
                        <input type="text" value="recovery@example.com">
                        <button class="btn btn-danger">Remove</button>
                    </div>

                    <button class="btn btn-secondary" onclick="addProfileCustomField(1)">
                        + Add Custom Field
                    </button>
                </div>

                <div class="profile-actions">
                    <button class="btn btn-danger" onclick="deleteProfile(1)">
                        Delete Profile
                    </button>
                </div>
            </div>

            <!-- PROFILE 2 -->
            <div class="profile-details-content" id="profileDetails2" style="display:none;">
                <div class="field-group-grid">
                    <div class="field-group">
                        <label>Profile Name</label>
                        <input type="text" value="Backup Profile">
                    </div>

                    <div class="field-group">
                        <label>Email</label>
                        <input type="email" value="backup.profile@example.com">
                    </div>

                    <div class="field-group">
                        <label>Password</label>
                        <input type="password" value="********">
                    </div>

                    <div class="field-group">
                        <label>2FA Code</label>
                        <input type="text" value="ABCDE12345">
                    </div>

                    <div class="field-group">
                        <label>Recovery Email</label>
                        <input type="email" value="recovery.backup@example.com">
                    </div>

                    <div class="field-group">
                        <label>Recovery Email Password</label>
                        <input type="password" value="********">
                    </div>
                </div>

                <!-- CUSTOM FIELDS -->
                <div class="profile-custom-fields">
                    <h4>Custom Fields</h4>

                    <button class="btn btn-secondary" onclick="addProfileCustomField(2)">
                        + Add Custom Field
                    </button>
                </div>

                <div class="profile-actions">
                    <button class="btn btn-danger" onclick="deleteProfile(2)">
                        Delete Profile
                    </button>
                </div>
            </div>

        </div>
    </div>
</div>

            <!-- Tab Content: Account Details -->
            <div class="account-tab-content" id="tabDetails" style="display:none;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2.5rem; row-gap: 2rem;">
                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.75rem; font-weight: 500; color: #2c3e50; font-size: 0.95rem;">ID</label>
                        <input type="text" id="modalTableId" value="1" readonly style="width: 100%; padding: 0.875rem; border: 1px solid #ddd; border-radius: 8px; background: #f5f5f5; font-size: 0.95rem;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.75rem; font-weight: 500; color: #2c3e50; font-size: 0.95rem;">Account ID</label>
                        <input type="text" id="modalAccountId" value="FB-12345" readonly style="width: 100%; padding: 0.875rem; border: 1px solid #ddd; border-radius: 8px; background: #f5f5f5; font-size: 0.95rem;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.75rem; font-weight: 500; color: #2c3e50; font-size: 0.95rem;">Account Name</label>
                        <input type="text" id="modalAccountName" value="Campaign Account 1" style="width: 100%; padding: 0.875rem; border: 1px solid #ddd; border-radius: 8px; font-size: 0.95rem;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Platform</label>
                        <input type="text" id="modalPlatform" value="Facebook" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Client</label>
                        <input type="text" id="modalClient" value="Client A" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Client Tag</label>
                        <input type="text" id="modalClientTag" value="Premium" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Asset Type</label>
                        <select id="modalAssetType" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="ad-account">Ad Account</option>
                            <option value="profile">Profile</option>
                            <option value="bm">BM</option>
                            <option value="page">Page</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Status</label>
                        <select id="modalStatus" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="active">Active</option>
                            <option value="in-review">In Review</option>
                            <option value="restricted">Restricted</option>
                            <option value="disabled">Disabled</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Balance Type</label>
                        <select id="modalBalanceType" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="general">General</option>
                            <option value="individual">Individual</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Balance</label>
                        <input type="text" id="modalBalance" value="$2,580.00" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Primary Access</label>
                        <input type="text" id="modalPrimaryAccess" value="Main Profile" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Account Type</label>
                        <select id="modalAccountType" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="cc">CC (Credit Card)</option>
                            <option value="cl">CL (Credit Line)</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Billing</label>
                        <select id="modalBilling" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="one-time">One Time</option>
                            <option value="recurring">Recurring</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Provider</label>
                        <input type="text" id="modalProvider" value="Adi" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>

                    <div class="field-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2c3e50;">Setup Account</label>
                        <input type="text" id="modalSetupAccount" value="$500" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px;">
                    </div>
                </div>
            </div>

            <!-- Tab Content: Cards -->
            <div class="account-tab-content" id="tabCards" style="display: none;">
                <div id="cardsList">
                    <div class="card-item">
                        <div class="card-chip"></div>
                        <div class="card-number">**** **** **** 1234</div>
                        <div class="card-info">
                            <div class="card-holder">
                                <div class="card-label">Card Holder</div>
                                <div class="card-value">John Doe</div>
                            </div>
                            <div class="card-type">Wallester</div>
                        </div>
                        <div class="card-actions">
                            <button class="btn">View Details</button>
                            <button class="btn btn-danger">Remove</button>
                        </div>
                    </div>
                    <div class="card-item">
                        <div class="card-chip"></div>
                        <div class="card-number">**** **** **** 5678</div>
                        <div class="card-info">
                            <div class="card-holder">
                                <div class="card-label">Card Holder</div>
                                <div class="card-value">Jane Smith</div>
                            </div>
                            <div class="card-type">TDX</div>
                        </div>
                        <div class="card-actions">
                            <button class="btn">View Details</button>
                            <button class="btn btn-danger">Remove</button>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="addCard()">+ Add New Card</button>
            </div>

            <!-- Save Button -->
            <div style="display: flex; gap: 12px; padding: 20px 24px; border-top: 1px solid #e5e5e5; position: sticky; bottom: 0; background: white;">
                <button class="btn" onclick="saveAllChanges()" style="flex: 1; background: #27ae60; color: white; padding: 12px 24px; font-size: 14px; font-weight: 500; border: none; border-radius: 8px; cursor: pointer;">Save All Changes</button>
            </div>
        </div>
    </div>

    <div class="modal" id="notesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Account Notes</h2>
                <button class="close-btn" onclick="closeNotesModal()">&times;</button>
            </div>

            <div class="field-group">
                <label>Account Name</label>
                <input type="text" id="notesAccountName" value="Campaign Account 1" readonly style="background: #f5f5f5; font-weight: 600;">
            </div>

            <div class="field-group">
                <label>Account ID</label>
                <input type="text" id="notesAccountId" value="FB-12345" readonly>
            </div>

            <div class="field-group">
                <label>Notes</label>
                <textarea id="notesText" rows="10" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; resize: vertical;">Sample notes for this account...</textarea>
            </div>

            <button class="btn" style="width: 100%;">Save Notes</button>
        </div>
    </div>

    <div class="modal" id="addAccountModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Account</h2>
                <button class="close-btn" onclick="closeAddAccountModal()">&times;</button>
            </div>

            <div class="field-group">
                <label>Account Name</label>
                <input type="text" id="addAccountName" placeholder="Enter account name">
            </div>

            <div class="field-group">
                <label>Email</label>
                <input type="email" id="addAccountEmail" placeholder="Enter email">
            </div>

            <div class="field-group">
                <label>Client</label>
                <input type="text" id="addAccountClient" placeholder="Enter client name">
            </div>

            <div class="field-group">
                <label>Options (Optional)</label>
                <textarea id="addAccountOptions" rows="4" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" placeholder="Enter any additional options..."></textarea>
            </div>

            <button class="btn" style="width: 100%;">Create Account</button>
        </div>
    </div>

    <div class="modal" id="addProfileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Profile</h2>
                <button class="close-btn" onclick="closeAddProfileModal()">&times;</button>
            </div>

            <div class="field-group">
                <label>Profile Name</label>
                <input type="text" id="addProfileName" placeholder="Enter profile name">
            </div>

            <div class="field-group">
                <label>Email</label>
                <input type="email" id="addProfileEmail" placeholder="Enter email">
            </div>

            <div class="field-group">
                <label>Password</label>
                <input type="password" id="addProfilePassword" placeholder="Enter password">
            </div>

            <div class="field-group">
                <label>2FA Code (Optional)</label>
                <input type="text" id="addProfileTwoFA" placeholder="Enter 2FA code">
            </div>

            <div class="field-group">
                <label>Recovery Email</label>
                <input type="email" id="addProfileRecoveryEmail" placeholder="Enter recovery email">
            </div>

            <div class="field-group">
                <label>Recovery Email Password</label>
                <input type="password" id="addProfileRecoveryPassword" placeholder="Enter recovery email password">
            </div>

            <div class="field-group">
                <label>Tag</label>
                <select id="addProfileTag" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="Primary">Primary</option>
                    <option value="Backup">Backup</option>
                </select>
            </div>

            <button class="btn" style="width: 100%;" onclick="submitAddProfile()">Create Profile</button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="confirm-modal" id="confirmModal">
        <div class="confirm-modal-content">
            <div class="confirm-modal-header">
                <h3>Switch Active Profile?</h3>
            </div>
            <div class="confirm-modal-body">
                <div style="padding: 0.75rem; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #3498db;">
                    <div style="margin-bottom: 0.4rem; font-size: 0.85rem;">
                        <strong>From:</strong> <span id="confirmCurrentProfile"></span>
                    </div>
                    <div style="font-size: 0.85rem;">
                        <strong>To:</strong> <span id="confirmNewProfile"></span>
                    </div>
                </div>
            </div>
            <div class="confirm-modal-footer">
                <button class="btn btn-secondary" onclick="cancelProfileSwitch()">Cancel</button>
                <button class="btn btn-primary" onclick="confirmProfileSwitch()">Switch</button>
            </div>
        </div>
    </div>

    <script>
        // Account Tab Switching
        function switchAccountTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.account-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.account-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.color = '#666';
                tab.style.borderBottom = '3px solid transparent';
            });
            
            // Show selected tab content
            document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
            
            // Add active class to selected tab
            const activeTab = document.querySelector(`.account-tab[data-tab="${tabName}"]`);
            activeTab.classList.add('active');
            activeTab.style.color = '#3498db';
            activeTab.style.borderBottom = '3px solid #3498db';
        }

        // Profile Tab Switching
        function switchProfileTab(profileNum) {
            // Hide all profile contents
            document.querySelectorAll('.profile-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all profile tabs
            document.querySelectorAll('.profile-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.background = 'white';
                tab.style.color = '#666';
            });
            
            // Show selected profile content
            document.getElementById('profileContent' + profileNum).style.display = 'block';
            
            // Add active class to selected profile tab
            const activeTabs = document.querySelectorAll('.profile-tab');
            activeTabs[profileNum - 1].classList.add('active');
            activeTabs[profileNum - 1].style.background = '#3498db';
            activeTabs[profileNum - 1].style.color = 'white';
        }

        function addProfileTab() {
            alert('Add new profile functionality');
        }

        function addProfileCustomField(profileNum) {
            alert('Add custom field to profile ' + profileNum);
        }

        // Variables for profile switch confirmation
        let pendingProfileSwitch = null;

        // Switch to profile - show details of selected profile
        function switchToProfile(profileId, skipConfirmation = false, clickEvent = null) {
            if (!currentAccountId) return;

            const account = accountsData[currentAccountId];
            if (!account) return;

            // Check if this is already the active profile
            if (account.activeProfileId === profileId) {
                return; // Already active, no need to do anything
            }

            // Get profile name for confirmation message
            const profiles = accountProfiles[currentAccountId];
            const newProfile = profiles ? profiles.find(p => p.id === profileId) : null;
            const currentProfile = profiles ? profiles.find(p => p.id === account.activeProfileId) : null;

            // Ask for confirmation unless skipped
            if (!skipConfirmation) {
                const currentProfileName = currentProfile ? currentProfile.name : 'Unknown';
                const newProfileName = newProfile ? newProfile.name : 'Unknown';
                
                // Store pending switch data
                pendingProfileSwitch = {
                    profileId: profileId,
                    currentProfileId: account.activeProfileId
                };

                // Show custom confirmation modal
                document.getElementById('confirmCurrentProfile').textContent = currentProfileName;
                document.getElementById('confirmNewProfile').textContent = newProfileName;
                
                const confirmModal = document.getElementById('confirmModal');
                const confirmOverlay = document.getElementById('confirmOverlay');
                
                // Position modal near the clicked radio button
                if (clickEvent && clickEvent.target) {
                    const rect = clickEvent.target.getBoundingClientRect();
                    const modalWidth = 320;
                    const modalHeight = 200; // approximate
                    
                    // Calculate position (to the right of the radio button)
                    let left = rect.right + 10;
                    let top = rect.top - 50;
                    
                    // Adjust if modal goes off screen
                    if (left + modalWidth > window.innerWidth) {
                        left = rect.left - modalWidth - 10; // Show on left instead
                    }
                    
                    if (top + modalHeight > window.innerHeight) {
                        top = window.innerHeight - modalHeight - 20;
                    }
                    
                    if (top < 0) {
                        top = 20;
                    }
                    
                    confirmModal.style.left = left + 'px';
                    confirmModal.style.top = top + 'px';
                } else {
                    // Fallback to center if no click event
                    confirmModal.style.left = '50%';
                    confirmModal.style.top = '50%';
                    confirmModal.style.transform = 'translate(-50%, -50%)';
                }
                
                confirmModal.classList.add('active');
                confirmOverlay.classList.add('active');
                
                return;
            }

            // Update the activeProfileId in account data
            account.activeProfileId = profileId;
            saveAccountsToStorage();

            // Hide all profile details
            document.querySelectorAll('.profile-details-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Show selected profile details
            const profileDetails = document.getElementById('profileDetails' + profileId);
            if (profileDetails) {
                profileDetails.style.display = 'block';
            }

            // Ensure the correct radio is checked
            const radios = document.querySelectorAll('input[name="activeProfile"]');
            radios.forEach(radio => {
                const row = radio.closest('tr');
                const rowProfileId = parseInt(row.getAttribute('data-profile'));
                radio.checked = (rowProfileId === profileId);
            });
        }

        function confirmProfileSwitch() {
            if (!pendingProfileSwitch) return;

            // Close modal
            document.getElementById('confirmModal').classList.remove('active');
            document.getElementById('confirmOverlay').classList.remove('active');

            // Perform the switch
            switchToProfile(pendingProfileSwitch.profileId, true);

            // Clear pending switch
            pendingProfileSwitch = null;
        }

        function cancelProfileSwitch() {
            if (!pendingProfileSwitch) return;

            // Revert the radio button to the current active profile
            const radios = document.querySelectorAll('input[name="activeProfile"]');
            radios.forEach(radio => {
                const row = radio.closest('tr');
                const rowProfileId = parseInt(row.getAttribute('data-profile'));
                radio.checked = (rowProfileId === pendingProfileSwitch.currentProfileId);
            });

            // Close modal
            document.getElementById('confirmModal').classList.remove('active');
            document.getElementById('confirmOverlay').classList.remove('active');

            // Clear pending switch
            pendingProfileSwitch = null;
        }

        function addProfile() {
            if (!currentAccountId) {
                alert('No account selected');
                return;
            }
            openAddProfileModal();
        }

        function openAddProfileModal() {
            document.getElementById('addProfileModal').classList.add('active');
            document.getElementById('addProfileOverlay').classList.add('active');
            
            // Clear form fields
            document.getElementById('addProfileName').value = '';
            document.getElementById('addProfileEmail').value = '';
            document.getElementById('addProfilePassword').value = '';
            document.getElementById('addProfileTwoFA').value = '';
            document.getElementById('addProfileTag').value = 'Primary';
        }

        function closeAddProfileModal() {
            document.getElementById('addProfileModal').classList.remove('active');
            document.getElementById('addProfileOverlay').classList.remove('active');
        }

        function submitAddProfile() {
            // Get form values
            const profileName = document.getElementById('addProfileName').value.trim();
            const profileEmail = document.getElementById('addProfileEmail').value.trim();
            const profilePassword = document.getElementById('addProfilePassword').value;
            const profileTwoFA = document.getElementById('addProfileTwoFA').value.trim();
            const profileRecoveryEmail = document.getElementById('addProfileRecoveryEmail').value.trim();
            const profileRecoveryPassword = document.getElementById('addProfileRecoveryPassword').value;
            const profileTag = document.getElementById('addProfileTag').value;

            // Validate required fields
            if (!profileName) {
                alert('Please enter a profile name');
                return;
            }
            if (!profileEmail) {
                alert('Please enter an email');
                return;
            }
            if (!profilePassword) {
                alert('Please enter a password');
                return;
            }

            // Get current account profiles
            if (!accountProfiles[currentAccountId]) {
                accountProfiles[currentAccountId] = [];
            }

            // Generate new profile ID (find max ID and add 1)
            let maxId = 0;
            Object.values(accountProfiles).forEach(profiles => {
                profiles.forEach(profile => {
                    if (profile.id > maxId) maxId = profile.id;
                });
            });
            const newProfileId = maxId + 1;

            // Create new profile object
            const newProfile = {
                id: newProfileId,
                name: profileName,
                email: profileEmail,
                password: profilePassword,
                twoFA: profileTwoFA,
                recoveryEmail: profileRecoveryEmail,
                recoveryPassword: profileRecoveryPassword,
                tag: profileTag,
                status: 'active'
            };

            // Add to accountProfiles
            accountProfiles[currentAccountId].push(newProfile);

            // Save to localStorage
            saveProfilesToStorage();

            // Add to the profiles table
            const profilesListBody = document.getElementById('profilesList');
            const row = document.createElement('tr');
            row.setAttribute('data-profile', newProfile.id);
            
            // Generate random 6-digit 2FA code
            const random2FA = Math.floor(100000 + Math.random() * 900000);
            
            row.innerHTML = `
                <td class="strong">
                    ${newProfile.name}
                    <span class="code-2fa" onclick="copy2FACode(this)" style="margin-left: 8px; padding: 4px 8px; background: #f0f0f0; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 12px; cursor: pointer; color: #3498db; font-weight: 600; transition: all 0.2s;" title="Click to copy">
                        ${random2FA}
                    </span>
                </td>
                <td>${newProfile.email}</td>
                <td class="center">
                    <span class="tag ${newProfile.tag === 'Primary' ? 'tag-primary' : 'tag-backup'}">${newProfile.tag}</span>
                </td>
                <td class="center">
                    <select class="profile-status-dropdown" data-profile-id="${newProfile.id}" data-account-id="${currentAccountId}" onchange="updateProfileStatus(${currentAccountId}, ${newProfile.id}, this.value)">
                        <option value="active" selected>‚óè Active</option>
                        <option value="suspended">‚óè Suspended</option>
                    </select>
                </td>
                <td class="center">
                    <span class="visibility-toggle" onclick="toggleVisibility(this)" style="cursor: pointer; font-size: 20px; transition: all 0.2s;" data-visible="true" title="Click to toggle visibility">
                        üëÅÔ∏è
                    </span>
                </td>
                <td class="center">
                    <input type="radio" name="activeProfile" onchange="switchToProfile(${newProfile.id}, false, event)">
                </td>
            `;
            profilesListBody.appendChild(row);

            // Initialize dropdown style
            const dropdown = row.querySelector('.profile-status-dropdown');
            if (dropdown) {
                updateProfileDropdownStyle(dropdown, newProfile.status);
            }

            // Create profile details section
            const profileDetailsContainer = document.querySelector('.profile-details-box');
            const newProfileDetails = document.createElement('div');
            newProfileDetails.className = 'profile-details-content';
            newProfileDetails.id = 'profileDetails' + newProfile.id;
            newProfileDetails.style.display = 'none';
            newProfileDetails.innerHTML = `
                <div class="field-group-grid">
                    <div class="field-group">
                        <label>Profile Name</label>
                        <input type="text" value="${newProfile.name}">
                    </div>

                    <div class="field-group">
                        <label>Email</label>
                        <input type="email" value="${newProfile.email}">
                    </div>

                    <div class="field-group">
                        <label>Password</label>
                        <input type="password" value="${newProfile.password}">
                    </div>

                    <div class="field-group">
                        <label>2FA Code</label>
                        <input type="text" value="${newProfile.twoFA}">
                    </div>

                    <div class="field-group">
                        <label>Recovery Email</label>
                        <input type="email" value="${newProfile.recoveryEmail || ''}">
                    </div>

                    <div class="field-group">
                        <label>Recovery Email Password</label>
                        <input type="password" value="${newProfile.recoveryPassword || ''}">
                    </div>
                </div>

                <div class="profile-custom-fields">
                    <h4>Custom Fields</h4>
                    <div class="custom-fields-list" id="customFieldsList${newProfile.id}">
                        <!-- Custom fields will be added here -->
                    </div>
                    <button class="btn btn-secondary" onclick="addProfileCustomField(${newProfile.id})">+ Add Custom Field</button>
                </div>

                <div class="profile-actions">
                    <button class="btn btn-danger" onclick="deleteProfile(${newProfile.id})">Delete Profile</button>
                </div>
            `;
            
            // Insert before the last profile details or at the end
            const existingDetails = profileDetailsContainer.querySelectorAll('.profile-details-content');
            if (existingDetails.length > 0) {
                existingDetails[existingDetails.length - 1].after(newProfileDetails);
            } else {
                profileDetailsContainer.appendChild(newProfileDetails);
            }

            // Close modal
            closeAddProfileModal();

            alert(`Profile "${newProfile.name}" added successfully!`);
        }

        function deleteProfile(profileId) {
            if (!currentAccountId) {
                alert('No account selected');
                return;
            }

            const profiles = accountProfiles[currentAccountId];
            if (!profiles) return;

            // Check if this is the only profile
            if (profiles.length === 1) {
                alert('Cannot delete the last profile. At least one profile must exist.');
                return;
            }
            
            // Check if this is the active profile
            const account = accountsData[currentAccountId];
            if (account && account.activeProfileId === profileId) {
                alert('Cannot delete the active profile. Please activate another profile first.');
                return;
            }
            
            if (confirm('Are you sure you want to delete this profile?')) {
                // Remove from accountProfiles array
                const profileIndex = profiles.findIndex(p => p.id === profileId);
                if (profileIndex !== -1) {
                    profiles.splice(profileIndex, 1);
                }

                // Save to localStorage
                saveProfilesToStorage();

                // Remove from table
                const row = document.querySelector(`#profilesList tr[data-profile="${profileId}"]`);
                if (row) {
                    row.remove();
                }

                // Remove profile details section
                const profileDetails = document.getElementById('profileDetails' + profileId);
                if (profileDetails) {
                    profileDetails.remove();
                }

                alert('Profile deleted successfully!');
            }
        }

        function addProfileCustomField(profileId) {
            const fieldName = prompt('Enter field name:');
            if (!fieldName || fieldName.trim() === '') {
                return;
            }

            const fieldValue = prompt('Enter field value:');
            if (fieldValue === null) {
                return; // User cancelled
            }

            // Find the custom fields list for this profile
            const customFieldsList = document.getElementById('customFieldsList' + profileId);
            if (!customFieldsList) {
                alert('Profile details not found');
                return;
            }

            // Create new custom field element
            const customFieldItem = document.createElement('div');
            customFieldItem.className = 'custom-field-item';
            customFieldItem.innerHTML = `
                <input type="text" value="${fieldName.trim()}" placeholder="Field Name">
                <input type="text" value="${fieldValue.trim()}" placeholder="Field Value">
                <button class="btn btn-danger" onclick="this.parentElement.remove()">Remove</button>
            `;

            customFieldsList.appendChild(customFieldItem);
        }

        // Profile names mapping
        const profileNames = {
            1: 'Main Profile',
            2: 'Gmail Main',
            3: 'TikTok Pro',
            4: 'Taboola Master',
            5: 'Snap Main',
            6: 'Backup Profile',
            7: 'Secondary Access',
            8: 'FB Premium',
            9: 'Google Fresh',
            10: 'TikTok New'
        };

        // Track current open account
        let currentAccountId = null;

        // Profiles data for each account
        const accountProfiles = {
            1: [ // Facebook account - Dennis Robertson
                { id: 1, name: 'Main Profile', email: 'main.fb@example.com', password: 'FbPass2024!', twoFA: 'JBSWY3DPEHPK3PXP', recoveryEmail: 'recovery.fb.main@gmail.com', recoveryPassword: 'RecPass123!', tag: 'Primary', status: 'active' }
            ],
            2: [ // Google account - Ada Account Pro
                { id: 2, name: 'Gmail Main', email: 'gmail.main@example.com', password: 'GoogleMain456!', twoFA: 'ABCDE12345', recoveryEmail: 'recovery.gmail.main@outlook.com', recoveryPassword: 'GmailRec456!', tag: 'Primary', status: 'active' },
                { id: 6, name: 'Gmail Backup', email: 'gmail.backup@example.com', password: 'GmailBackup789!', twoFA: 'FGHIJ67890', recoveryEmail: 'recovery.gmail.backup@yahoo.com', recoveryPassword: 'BackupRec789!', tag: 'Backup', status: 'active' }
            ],
            3: [ // TikTok account - TikTok Campaign
                { id: 3, name: 'TikTok Pro', email: 'tiktok.pro@example.com', password: 'TikTokPro321!', twoFA: 'KLMNO11111', recoveryEmail: 'recovery.tiktok@gmail.com', recoveryPassword: 'TikTokRec321!', tag: 'Primary', status: 'active' }
            ],
            4: [ // Taboola account - Native Ads Pro
                { id: 4, name: 'Taboola Master', email: 'taboola.master@example.com', password: 'TaboolaMaster654!', twoFA: 'PQRST22222', recoveryEmail: 'recovery.taboola@protonmail.com', recoveryPassword: 'TaboolaRec654!', tag: 'Primary', status: 'active' }
            ],
            5: [ // Snapchat account - Snap Ads Elite
                { id: 5, name: 'Snap Main', email: 'snap.main@example.com', password: 'SnapMain987!', twoFA: 'UVWXY33333', recoveryEmail: 'recovery.snap@gmail.com', recoveryPassword: 'SnapRec987!', tag: 'Primary', status: 'suspended' }
            ],
            6: [ // Facebook unassigned - FB Premium Account
                { id: 8, name: 'FB Premium', email: 'fb.premium@example.com', password: 'FbPremium111!', twoFA: 'AAAAA44444', recoveryEmail: 'recovery.fb.premium@gmail.com', recoveryPassword: 'PremiumRec111!', tag: 'Primary', status: 'active' }
            ],
            7: [ // Google unassigned - Google Ads Fresh
                { id: 9, name: 'Google Fresh', email: 'google.fresh@example.com', password: 'GoogleFresh222!', twoFA: 'BBBBB55555', recoveryEmail: 'recovery.google.fresh@outlook.com', recoveryPassword: 'FreshRec222!', tag: 'Primary', status: 'active' }
            ],
            8: [ // TikTok unassigned - TikTok New Profile
                { id: 10, name: 'TikTok New', email: 'tiktok.new@example.com', password: 'TikTokNew333!', twoFA: 'CCCCC66666', recoveryEmail: 'recovery.tiktok.new@yahoo.com', recoveryPassword: 'NewTikRec333!', tag: 'Primary', status: 'active' }
            ]
        };

        // MIGRATION: Clear old localStorage data to force reload with new recovery email fields
        // This runs once to update old data - you can remove this after first load
        (function migrateProfileData() {
            const savedProfiles = localStorage.getItem('accountProfiles');
            if (savedProfiles) {
                const parsedProfiles = JSON.parse(savedProfiles);
                let needsUpdate = false;
                
                // Check if any profile is missing recovery email fields
                Object.keys(parsedProfiles).forEach(accountId => {
                    parsedProfiles[accountId].forEach(profile => {
                        if (!profile.hasOwnProperty('recoveryEmail')) {
                            needsUpdate = true;
                        }
                    });
                });
                
                // If old data detected, clear it to force reload from default data
                if (needsUpdate) {
                    console.log('Migrating old profile data to include recovery email fields...');
                    localStorage.removeItem('accountProfiles');
                }
            }
        })();

        // MIGRATION: Clear old accounts data to update unassigned accounts billing to "-"
        (function migrateAccountsData() {
            const savedAccounts = localStorage.getItem('accountsData');
            if (savedAccounts) {
                const parsedAccounts = JSON.parse(savedAccounts);
                let needsUpdate = false;
                
                // Check if unassigned accounts have billing values other than "-"
                Object.keys(parsedAccounts).forEach(accountId => {
                    const account = parsedAccounts[accountId];
                    if (account.client === 'Unassigned' && account.billing !== '-') {
                        needsUpdate = true;
                    }
                    // Also check if proxy field exists (we removed it)
                    if (account.hasOwnProperty('proxy')) {
                        needsUpdate = true;
                    }
                });
                
                // If old data detected, clear it to force reload from default data
                if (needsUpdate) {
                    console.log('Migrating old accounts data to update unassigned billing and remove proxy...');
                    localStorage.removeItem('accountsData');
                }
            }
        })();

        // Mock account data
        const accountsData = {
            1: {
                id: 'FB-7832',
                name: 'Dennis Robertson - Skyblue Media',
                platform: 'Facebook',
                client: 'Client A',
                clientTag: 'Scaling 01',
                assetType: 'ad-account',
                status: 'active',
                balanceType: 'general',
                balance: 'Shared wallet',
                primaryAccess: 'Main Profile',
                activeProfileId: 1,
                accountType: 'cl',
                billing: 'recurring',
                proxy: '192.168.1.1:8080',
                provider: 'Provider A',
                setupAccount: '$500'
            },
            2: {
                id: 'GG-67890',
                name: 'Ada Account Pro - Client B',
                platform: 'Google',
                client: 'Client B',
                clientTag: 'Brand X',
                assetType: 'ad-account',
                status: 'in-review',
                balanceType: 'individual',
                balance: '$1,080.00',
                primaryAccess: 'Gmail Main',
                activeProfileId: 2,
                accountType: 'cl',
                billing: 'recurring',
                proxy: '192.168.1.2:8080',
                provider: 'Provider B',
                setupAccount: '$750'
            },
            3: {
                id: 'TT-45678',
                name: 'TikTok Campaign - Client A',
                platform: 'TikTok',
                client: 'Client A',
                clientTag: 'Testing',
                assetType: 'ad-account',
                status: 'active',
                balanceType: 'general',
                balance: 'Shared wallet',
                primaryAccess: 'TikTok Pro',
                activeProfileId: 3,
                accountType: 'cc',
                billing: 'one-time',
                proxy: '192.168.1.3:8080',
                provider: 'Provider C',
                setupAccount: '$300'
            },
            4: {
                id: 'TB-98765',
                name: 'Native Ads Pro - Client C',
                platform: 'Taboola',
                client: 'Client C',
                clientTag: 'Premium',
                assetType: 'profile',
                status: 'active',
                balanceType: 'individual',
                balance: '$5,900.00',
                primaryAccess: 'Taboola Master',
                activeProfileId: 4,
                accountType: 'cl',
                billing: 'recurring',
                proxy: '192.168.1.4:8080',
                provider: 'Provider D',
                setupAccount: '$600'
            },
            5: {
                id: 'SC-11223',
                name: 'Snap Ads Elite - Client B',
                platform: 'Snapchat',
                client: 'Client B',
                clientTag: 'Launch',
                assetType: 'ad-account',
                status: 'restricted',
                balanceType: 'general',
                balance: 'Shared wallet',
                primaryAccess: 'Snap Main',
                activeProfileId: 5,
                accountType: 'cc',
                billing: 'one-time',
                proxy: '192.168.1.5:8080',
                provider: 'Provider E',
                setupAccount: '$450'
            },
            6: {
                id: 'FB-9988',
                name: 'FB Premium Account - Unassigned',
                platform: 'Facebook',
                client: 'Unassigned',
                clientTag: '-',
                assetType: 'ad-account',
                status: 'active',
                balanceType: 'general',
                balance: 'Shared wallet',
                primaryAccess: 'FB Premium',
                activeProfileId: 8,
                accountType: 'cl',
                billing: '-',
                proxy: '192.168.1.6:8080',
                provider: 'Provider F',
                setupAccount: '$400'
            },
            7: {
                id: 'GG-5544',
                name: 'Google Ads Fresh - Unassigned',
                platform: 'Google',
                client: 'Unassigned',
                clientTag: '-',
                assetType: 'ad-account',
                status: 'active',
                balanceType: 'individual',
                balance: '$0.00',
                primaryAccess: 'Google Fresh',
                activeProfileId: 9,
                accountType: 'cc',
                billing: '-',
                proxy: '192.168.1.7:8080',
                provider: 'Provider G',
                setupAccount: '$350'
            },
            8: {
                id: 'TT-7766',
                name: 'TikTok New Profile - Unassigned',
                platform: 'TikTok',
                client: 'Unassigned',
                clientTag: '-',
                assetType: 'profile',
                status: 'in-review',
                balanceType: 'general',
                balance: 'Shared wallet',
                primaryAccess: 'TikTok New',
                activeProfileId: 10,
                accountType: 'cl',
                billing: '-',
                proxy: '192.168.1.8:8080',
                provider: 'Provider H',
                setupAccount: '$300'
            }
        };

        // Initialize table with correct profile names on page load
        function initializeTable() {
            Object.keys(accountsData).forEach(accountId => {
                const account = accountsData[accountId];
                const accessSpan = document.getElementById('access-' + accountId);
                if (accessSpan && account.activeProfileId) {
                    accessSpan.textContent = profileNames[account.activeProfileId];
                }
            });
        }

        // Call initialization when page loads
        window.addEventListener('DOMContentLoaded', function() {
            loadAccountsFromStorage();
            initializeTable();
            updateAllStatusDropdowns();
            // Apply initial filter to show only assigned accounts
            applyAllFilters();
        });

        // Load accounts data from localStorage
        function loadAccountsFromStorage() {
            const savedAccounts = localStorage.getItem('accountsData');
            if (savedAccounts) {
                const parsedAccounts = JSON.parse(savedAccounts);
                // Replace accountsData with saved data
                Object.keys(parsedAccounts).forEach(accountId => {
                    if (accountsData[accountId]) {
                        accountsData[accountId] = parsedAccounts[accountId];
                    }
                });
            }

            const savedProfiles = localStorage.getItem('accountProfiles');
            if (savedProfiles) {
                const parsedProfiles = JSON.parse(savedProfiles);
                Object.keys(parsedProfiles).forEach(accountId => {
                    accountProfiles[accountId] = parsedProfiles[accountId];
                });
            }

            const savedProfileNames = localStorage.getItem('profileNames');
            if (savedProfileNames) {
                const parsedNames = JSON.parse(savedProfileNames);
                Object.keys(parsedNames).forEach(profileId => {
                    profileNames[profileId] = parsedNames[profileId];
                });
            }
        }

        // Save accounts data to localStorage
        function saveAccountsToStorage() {
            localStorage.setItem('accountsData', JSON.stringify(accountsData));
        }

        // Update all status dropdowns based on accountsData
        function updateAllStatusDropdowns() {
            Object.keys(accountsData).forEach(accountId => {
                const account = accountsData[accountId];
                const dropdown = document.querySelector(`select[data-account-id="${accountId}"]`);
                if (dropdown && account) {
                    dropdown.value = account.status;
                    updateDropdownStyle(dropdown, account.status);
                    
                    // Update row data-status attribute
                    const row = dropdown.closest('tr');
                    if (row) {
                        row.setAttribute('data-status', account.status);
                    }
                }
            });
        }

        // Update dropdown styling
        function updateDropdownStyle(dropdown, status) {
            switch(status) {
                case 'active':
                    dropdown.style.background = '#d4f4dd';
                    dropdown.style.color = '#0d7a2c';
                    break;
                case 'in-review':
                    dropdown.style.background = '#fff4e6';
                    dropdown.style.color = '#e67700';
                    break;
                case 'restricted':
                    dropdown.style.background = '#ffebee';
                    dropdown.style.color = '#c62828';
                    break;
                case 'disabled':
                    dropdown.style.background = '#f5f5f5';
                    dropdown.style.color = '#666';
                    break;
            }
        }

        function updateAccountStatus(accountId, newStatus) {
            const account = accountsData[accountId];
            if (!account) return;

            // Update account data
            account.status = newStatus;

            // Save to localStorage
            saveAccountsToStorage();

            // Update data-status attribute on the row
            const dropdown = document.querySelector(`select[data-account-id="${accountId}"]`);
            const row = dropdown ? dropdown.closest('tr') : null;
            if (row) {
                row.setAttribute('data-status', newStatus);
            }

            // Update dropdown styling
            if (dropdown) {
                updateDropdownStyle(dropdown, newStatus);
            }

            console.log(`Account ${accountId} status updated to: ${newStatus} and saved to localStorage`);
        }

        function updateProfileStatus(accountId, profileId, newStatus) {
            // Find the profile in accountProfiles
            const profiles = accountProfiles[accountId];
            if (!profiles) return;

            const profile = profiles.find(p => p.id === profileId);
            if (!profile) return;

            // Update profile status
            profile.status = newStatus;

            // Save to localStorage
            saveProfilesToStorage();

            // Update dropdown styling
            const dropdown = document.querySelector(`select[data-profile-id="${profileId}"][data-account-id="${accountId}"]`);
            if (dropdown) {
                updateProfileDropdownStyle(dropdown, newStatus);
            }

            console.log(`Profile ${profileId} status updated to: ${newStatus} and saved to localStorage`);
        }

        function updateProfileDropdownStyle(dropdown, status) {
            switch(status) {
                case 'active':
                    dropdown.style.background = '#d4f4dd';
                    dropdown.style.color = '#0d7a2c';
                    break;
                case 'suspended':
                    dropdown.style.background = '#ffebee';
                    dropdown.style.color = '#c62828';
                    break;
            }
        }

        function openModal(accountId) {
            const account = accountsData[accountId];
            if (!account) {
                alert('Account not found!');
                return;
            }

            // Store current account ID
            currentAccountId = accountId;

            // Populate header with account name
            document.getElementById('modalHeaderAccountName').textContent = account.name;

            // Populate Details tab with account data
            document.getElementById('modalTableId').value = accountId;
            document.getElementById('modalAccountId').value = account.id;
            document.getElementById('modalAccountName').value = account.name;
            document.getElementById('modalPlatform').value = account.platform;
            document.getElementById('modalClient').value = account.client;
            document.getElementById('modalClientTag').value = account.clientTag;
            document.getElementById('modalAssetType').value = account.assetType;
            document.getElementById('modalStatus').value = account.status;
            document.getElementById('modalBalanceType').value = account.balanceType;
            document.getElementById('modalBalance').value = account.balance;
            document.getElementById('modalPrimaryAccess').value = account.primaryAccess;
            document.getElementById('modalAccountType').value = account.accountType;
            document.getElementById('modalBilling').value = account.billing;
            document.getElementById('modalProvider').value = account.provider;

            // Populate Profiles tab with account-specific profiles
            const profiles = accountProfiles[accountId] || [];
            const profilesListBody = document.getElementById('profilesList');
            profilesListBody.innerHTML = ''; // Clear existing profiles

            // Ensure there's a valid activeProfileId
            if (!account.activeProfileId && profiles.length > 0) {
                account.activeProfileId = profiles[0].id;
                console.log(`Account ${accountId}: No activeProfileId, setting to first profile: ${profiles[0].id}`);
            }

            console.log(`Account ${accountId}: activeProfileId = ${account.activeProfileId}, profiles:`, profiles);

            let hasCheckedProfile = false;
            profiles.forEach((profile, index) => {
                const isActive = profile.id === account.activeProfileId;
                if (isActive) hasCheckedProfile = true;
                
                // Generate random 6-digit 2FA code for display
                const random2FA = Math.floor(100000 + Math.random() * 900000);
                
                const row = document.createElement('tr');
                row.setAttribute('data-profile', profile.id);
                row.innerHTML = `
                    <td class="strong">
                        ${profile.name}
                        <span class="code-2fa" onclick="copy2FACode(this)" style="margin-left: 8px; padding: 4px 8px; background: #f0f0f0; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 12px; cursor: pointer; color: #3498db; font-weight: 600; transition: all 0.2s;" title="Click to copy">
                            ${random2FA}
                        </span>
                    </td>
                    <td>${profile.email}</td>
                    <td class="center">
                        <span class="tag ${profile.tag === 'Primary' ? 'tag-primary' : 'tag-backup'}">${profile.tag}</span>
                    </td>
                    <td class="center">
                        <select class="profile-status-dropdown" data-profile-id="${profile.id}" data-account-id="${currentAccountId}" onchange="updateProfileStatus(${currentAccountId}, ${profile.id}, this.value)">
                            <option value="active" ${profile.status === 'active' ? 'selected' : ''}>‚óè Active</option>
                            <option value="suspended" ${profile.status === 'suspended' ? 'selected' : ''}>‚óè Suspended</option>
                        </select>
                    </td>
                    <td class="center">
                        <span class="visibility-toggle" onclick="toggleVisibility(this)" style="cursor: pointer; font-size: 20px; transition: all 0.2s;" data-visible="true" title="Click to toggle visibility">
                            üëÅÔ∏è
                        </span>
                    </td>
                    <td class="center">
                        <input type="radio" name="activeProfile" ${isActive ? 'checked' : ''} onchange="switchToProfile(${profile.id}, false, event)">
                    </td>
                `;
                profilesListBody.appendChild(row);
                
                // Initialize dropdown style after adding to DOM
                const dropdown = row.querySelector('.profile-status-dropdown');
                if (dropdown) {
                    updateProfileDropdownStyle(dropdown, profile.status);
                }
                
                // Force check the radio button if it should be active
                if (isActive) {
                    const radio = row.querySelector('input[type="radio"]');
                    if (radio) {
                        radio.checked = true;
                        console.log(`Forced checked on profile ${profile.id}`);
                    }
                }
            });

            // If no profile was checked, force check the first one
            if (!hasCheckedProfile && profiles.length > 0) {
                console.log(`Account ${accountId}: No profile was checked, forcing first profile`);
                account.activeProfileId = profiles[0].id;
                const firstRadio = document.querySelector('input[name="activeProfile"]');
                if (firstRadio) {
                    firstRadio.checked = true;
                    console.log(`Forced checked on first radio button`);
                }
            }

            // Populate profile details sections
            const profileDetailsBox = document.querySelector('.profile-details-box');
            // Remove all existing profile details
            const existingDetails = profileDetailsBox.querySelectorAll('.profile-details-content');
            existingDetails.forEach(detail => detail.remove());

            // Add profile details for each profile
            profiles.forEach(profile => {
                const isActive = profile.id === account.activeProfileId;
                const detailsDiv = document.createElement('div');
                detailsDiv.className = 'profile-details-content';
                detailsDiv.id = 'profileDetails' + profile.id;
                detailsDiv.style.display = isActive ? 'block' : 'none';
                
                detailsDiv.innerHTML = `
                    <div class="field-group-grid">
                        <div class="field-group">
                            <label>Profile Name</label>
                            <input type="text" value="${profile.name}">
                        </div>

                        <div class="field-group">
                            <label>Email</label>
                            <input type="email" value="${profile.email}">
                        </div>

                        <div class="field-group">
                            <label>Password</label>
                            <input type="password" value="${profile.password}">
                        </div>

                        <div class="field-group">
                            <label>2FA Code</label>
                            <input type="text" value="${profile.twoFA || ''}">
                        </div>

                        <div class="field-group">
                            <label>Recovery Email</label>
                            <input type="email" value="${profile.recoveryEmail || ''}">
                        </div>

                        <div class="field-group">
                            <label>Recovery Email Password</label>
                            <input type="password" value="${profile.recoveryPassword || ''}">
                        </div>
                    </div>

                    <!-- CUSTOM FIELDS -->
                    <div class="profile-custom-fields">
                        <h4>Custom Fields</h4>

                        <button class="btn btn-secondary" onclick="addProfileCustomField(${profile.id})">
                            + Add Custom Field
                        </button>
                    </div>

                    <div class="profile-actions">
                        <button class="btn btn-danger" onclick="deleteProfile(${profile.id})">
                            Delete Profile
                        </button>
                    </div>
                `;
                
                profileDetailsBox.appendChild(detailsDiv);
            });

            // Show modal
            document.getElementById('accountModal').classList.add('active');
            document.getElementById('overlay').classList.add('active');
        }

        function saveAllChanges() {
            if (!currentAccountId) {
                alert('No account selected!');
                return;
            }

            // Validate that a profile is selected
            const checkedRadio = document.querySelector('input[name="activeProfile"]:checked');
            if (!checkedRadio) {
                alert('Please select an active profile before saving!');
                return;
            }

            const account = accountsData[currentAccountId];
            
            // Save Details tab data
            account.id = document.getElementById('modalAccountId').value;
            account.name = document.getElementById('modalAccountName').value;
            account.platform = document.getElementById('modalPlatform').value;
            account.client = document.getElementById('modalClient').value;
            account.clientTag = document.getElementById('modalClientTag').value;
            account.assetType = document.getElementById('modalAssetType').value;
            account.status = document.getElementById('modalStatus').value;
            account.balanceType = document.getElementById('modalBalanceType').value;
            account.balance = document.getElementById('modalBalance').value;
            account.primaryAccess = document.getElementById('modalPrimaryAccess').value;
            account.accountType = document.getElementById('modalAccountType').value;
            account.billing = document.getElementById('modalBilling').value;
            account.proxy = document.getElementById('modalProxy').value;
            account.provider = document.getElementById('modalProvider').value;

            // Save Profiles data
            const profiles = accountProfiles[currentAccountId] || [];
            profiles.forEach(profile => {
                const profileDetailsDiv = document.getElementById('profileDetails' + profile.id);
                if (profileDetailsDiv) {
                    const inputs = profileDetailsDiv.querySelectorAll('input');
                    profile.name = inputs[0].value; // Profile Name
                    profile.email = inputs[1].value; // Email
                    profile.password = inputs[2].value; // Password
                    profile.twoFA = inputs[3].value; // 2FA Code
                }
            });

            // Update active profile based on radio selection
            const profileRow = checkedRadio.closest('tr');
            const newActiveProfileId = parseInt(profileRow.getAttribute('data-profile'));
            account.activeProfileId = newActiveProfileId;
            
            // Update the profile name in profileNames mapping
            const activeProfile = profiles.find(p => p.id === newActiveProfileId);
            if (activeProfile) {
                account.primaryAccess = activeProfile.name;
                profileNames[newActiveProfileId] = activeProfile.name;
                
                // Update the Access column in the table
                const accessSpan = document.getElementById('access-' + currentAccountId);
                if (accessSpan) {
                    accessSpan.textContent = activeProfile.name;
                }
            }

            // Save everything to localStorage
            saveAccountsToStorage();
            saveProfilesToStorage();

            // Show success message
            alert('All changes saved successfully!');
            
            // Optional: close modal after saving
            // closeModal();
        }

        // Save accounts data to localStorage (enhanced version)
        function saveAccountsToStorage() {
            localStorage.setItem('accountsData', JSON.stringify(accountsData));
        }

        // Save profiles data to localStorage
        function saveProfilesToStorage() {
            localStorage.setItem('accountProfiles', JSON.stringify(accountProfiles));
            localStorage.setItem('profileNames', JSON.stringify(profileNames));
        }

        // Load accounts data from localStorage (enhanced version)
        function loadAccountsFromStorage() {
            const savedAccounts = localStorage.getItem('accountsData');
            if (savedAccounts) {
                const parsedAccounts = JSON.parse(savedAccounts);
                // Replace accountsData with saved data
                Object.keys(parsedAccounts).forEach(accountId => {
                    if (accountsData[accountId]) {
                        accountsData[accountId] = parsedAccounts[accountId];
                    }
                });
            }

            const savedProfiles = localStorage.getItem('accountProfiles');
            if (savedProfiles) {
                const parsedProfiles = JSON.parse(savedProfiles);
                Object.keys(parsedProfiles).forEach(accountId => {
                    accountProfiles[accountId] = parsedProfiles[accountId];
                });
            }

            const savedProfileNames = localStorage.getItem('profileNames');
            if (savedProfileNames) {
                const parsedNames = JSON.parse(savedProfileNames);
                Object.keys(parsedNames).forEach(profileId => {
                    profileNames[profileId] = parsedNames[profileId];
                });
            }
        }

        function closeModal() {
            document.getElementById('accountModal').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }

        function openNotesModal(accountId) {
            // Get account data
            const account = accountsData[accountId];
            if (account) {
                document.getElementById('notesAccountName').value = account.name;
                document.getElementById('notesAccountId').value = account.id;
                // Load notes if they exist
                if (account.notes) {
                    document.getElementById('notesText').value = account.notes;
                } else {
                    document.getElementById('notesText').value = '';
                }
            }
            
            document.getElementById('notesModal').classList.add('active');
            document.getElementById('notesOverlay').classList.add('active');
        }

        function closeNotesModal() {
            document.getElementById('notesModal').classList.remove('active');
            document.getElementById('notesOverlay').classList.remove('active');
        }
        
        // ================= LOGIN DETAILS POPUP =================
        
        function showLoginDetails(accountId) {
            const account = accountsData[accountId];
            if (!account) return;
            
            // Get the active profile for this account
            const profiles = accountProfiles[accountId];
            if (!profiles || profiles.length === 0) return;
            
            // Find the active profile
            const activeProfile = profiles.find(p => p.id === account.activeProfileId) || profiles[0];
            
            // Populate popup with profile data
            document.getElementById('loginProfileName').textContent = activeProfile.name;
            document.getElementById('loginEmail').value = activeProfile.email;
            document.getElementById('loginPassword').value = activeProfile.password;
            
            // Show popup
            document.getElementById('loginDetailsOverlay').style.display = 'flex';
            document.getElementById('loginDetailsPopup').style.display = 'block';
        }
        
        function closeLoginDetails() {
            document.getElementById('loginDetailsOverlay').style.display = 'none';
            document.getElementById('loginDetailsPopup').style.display = 'none';
        }
        
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('loginPassword');
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
            } else {
                passwordInput.type = 'password';
            }
        }
        
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            
            // Show feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚úì';
            button.style.background = '#27ae60';
            
            setTimeout(() => {
                button.textContent = originalText;
                button.style.background = elementId === 'loginEmail' ? '#3498db' : '#3498db';
            }, 1500);
        }

        function openAddAccountModal() {
            document.getElementById('addAccountModal').classList.add('active');
            document.getElementById('addAccountOverlay').classList.add('active');
        }

        function closeAddAccountModal() {
            document.getElementById('addAccountModal').classList.remove('active');
            document.getElementById('addAccountOverlay').classList.remove('active');
        }

        function toggleMoreFilters(event) {
            event.stopPropagation();
            const dropdown = document.getElementById('moreFiltersDropdown');
            dropdown.classList.toggle('active');
        }

        function applyMoreFilters() {
            // Filters are already applied via event listeners
            document.getElementById('moreFiltersDropdown').classList.remove('active');
        }

        function clearMoreFilters() {
            document.getElementById('tagFilter').value = '';
            document.getElementById('assetTypeFilter').value = '';
            document.getElementById('balanceTypeFilter').value = '';
            document.getElementById('contractFilter').value = '';
            
            // Trigger change events to update the table
            document.getElementById('tagFilter').dispatchEvent(new Event('change'));
            document.getElementById('assetTypeFilter').dispatchEvent(new Event('change'));
            document.getElementById('balanceTypeFilter').dispatchEvent(new Event('change'));
            document.getElementById('contractFilter').dispatchEvent(new Event('change'));
        }

        function clearAllFilters() {
            // Clear main filters
            document.getElementById('searchInput').value = '';
            document.getElementById('platformFilter').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('assignedFilter').value = '';
            
            // Clear more filters
            clearMoreFilters();
            
            // Show all rows
            const rows = document.querySelectorAll('#accountsTable tr');
            rows.forEach(row => {
                row.style.display = '';
            });
        }

        function addCustomField() {
            const list = document.getElementById('customFieldsList');
            const newField = document.createElement('div');
            newField.className = 'custom-field-item';
            newField.innerHTML = `
                <input type="text" placeholder="Field name" style="flex: 1;">
                <input type="text" placeholder="Value" style="flex: 1;">
                <button class="btn" onclick="this.parentElement.remove()" style="padding: 0.5rem;">Remove</button>
            `;
            list.appendChild(newField);
        }

        function switchProfileTab(profileId) {
            // Hide all profile contents
            document.querySelectorAll('.profile-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.profile-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected profile content
            document.getElementById('profileContent' + profileId).style.display = 'block';
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function addProfileTab() {
            alert('Add new profile functionality - to be implemented');
        }

        function addProfileCustomField(profileId) {
            const profileContent = document.getElementById('profileContent' + profileId);
            const customFieldsDiv = profileContent.querySelector('.profile-custom-fields');
            const addButton = customFieldsDiv.querySelector('.btn');
            
            const newField = document.createElement('div');
            newField.className = 'custom-field-item';
            newField.innerHTML = `
                <input type="text" placeholder="Field name" style="flex: 1;">
                <input type="text" placeholder="Value" style="flex: 1;">
                <button class="btn" onclick="this.parentElement.remove()" style="padding: 0.5rem;">Remove</button>
            `;
            
            customFieldsDiv.insertBefore(newField, addButton);
        }

        function addCard() {
            const list = document.getElementById('cardsList');
            const newCard = document.createElement('div');
            newCard.className = 'card-item';
            newCard.innerHTML = `
                <div><strong>Card Mask:</strong> <input type="text" placeholder="**** **** **** 0000" style="width: 150px;"></div>
                <div><strong>Name:</strong> <input type="text" placeholder="Name on card" style="width: 150px;"></div>
                <div><strong>Spend:</strong> <input type="text" placeholder="$0" style="width: 100px;"></div>
                <div><strong>Type:</strong> <select style="width: 120px; padding: 0.3rem;">
                    <option value="wallester">Wallester</option>
                    <option value="tdx">TDX</option>
                </select></div>
                <button class="btn" onclick="this.parentElement.remove()" style="padding: 0.3rem 0.8rem; margin-top: 0.5rem;">Remove</button>
            `;
            list.appendChild(newCard);
        }

        // Simple search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            applyAllFilters();
        });

        // Platform filter
        document.getElementById('platformFilter').addEventListener('change', function(e) {
            applyAllFilters();
        });

        // Status filter
        document.getElementById('statusFilter').addEventListener('change', function(e) {
            applyAllFilters();
        });

        // Additional filters (from More Filters modal)
        document.getElementById('assignedFilter').addEventListener('change', function(e) {
            applyAllFilters();
        });

        document.getElementById('assetTypeFilter').addEventListener('change', function(e) {
            applyAllFilters();
        });

        document.getElementById('balanceTypeFilter').addEventListener('change', function(e) {
            applyAllFilters();
        });

        document.getElementById('contractFilter').addEventListener('change', function(e) {
            applyAllFilters();
        });

        document.getElementById('tagFilter').addEventListener('change', function(e) {
            applyAllFilters();
        });

        // Unified filter function that checks all filters together
        function applyAllFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const platform = document.getElementById('platformFilter').value.toLowerCase();
            const status = document.getElementById('statusFilter').value.toLowerCase();
            const assigned = document.getElementById('assignedFilter').value.toLowerCase();
            const assetType = document.getElementById('assetTypeFilter').value.toLowerCase();
            const balanceType = document.getElementById('balanceTypeFilter').value.toLowerCase();
            const contract = document.getElementById('contractFilter').value.toLowerCase();
            const tag = document.getElementById('tagFilter').value.toLowerCase();

            const rows = document.querySelectorAll('#accountsTable tr');
            rows.forEach(row => {
                let show = true;

                // Search filter
                if (searchTerm && !row.textContent.toLowerCase().includes(searchTerm)) {
                    show = false;
                }

                // Platform filter
                if (platform && row.getAttribute('data-platform') !== platform) {
                    show = false;
                }

                // Status filter
                if (status && row.getAttribute('data-status') !== status) {
                    show = false;
                }

                // Assigned filter
                if (assigned) {
                    const rowAssigned = row.getAttribute('data-assigned');
                    if (assigned === 'assigned') {
                        // Show only assigned accounts (anything that's not 'unassigned')
                        if (rowAssigned === 'unassigned' || !rowAssigned) {
                            show = false;
                        }
                    } else if (assigned === 'unassigned') {
                        // Show only unassigned accounts
                        if (rowAssigned !== 'unassigned') {
                            show = false;
                        }
                    } else {
                        // Show specific client (client-a, client-b, etc.)
                        if (rowAssigned !== assigned) {
                            show = false;
                        }
                    }
                }

                // Asset type filter
                if (assetType && row.getAttribute('data-asset') !== assetType) {
                    show = false;
                }

                // Balance type filter
                if (balanceType && row.getAttribute('data-balance') !== balanceType) {
                    show = false;
                }

                // Contract filter
                if (contract && row.getAttribute('data-contract') !== contract) {
                    show = false;
                }

                // Tag filter
                if (tag && row.getAttribute('data-tag') !== tag) {
                    show = false;
                }

                row.style.display = show ? '' : 'none';
            });
        }

        // ================= DELETE ACCOUNTS FUNCTIONALITY =================
        
        function toggleSelectAll(checkbox) {
            const checkboxes = document.querySelectorAll('.account-checkbox');
            checkboxes.forEach(cb => {
                if (cb.closest('tr').style.display !== 'none') {
                    cb.checked = checkbox.checked;
                }
            });
            updateDeleteButton();
        }

        function updateDeleteButton() {
            const checked = document.querySelectorAll('.account-checkbox:checked');
            const deleteBtn = document.getElementById('deleteSelectedBtn');
            const countSpan = document.getElementById('selectedCount');
            
            if (checked.length > 0) {
                deleteBtn.style.display = 'block';
                countSpan.textContent = checked.length;
            } else {
                deleteBtn.style.display = 'none';
            }
        }

        function deleteSelectedAccounts() {
            const checked = document.querySelectorAll('.account-checkbox:checked');
            if (checked.length === 0) return;
            
            const accountIds = Array.from(checked).map(cb => cb.value);
            const accountsToDelete = accountIds.map(id => accountsData[id]).filter(a => a);
            
            if (accountsToDelete.length === 0) {
                alert('No valid accounts selected');
                return;
            }
            
            // Store accounts to delete
            window.accountsToDelete = accountsToDelete;
            window.accountIdsToDelete = accountIds;
            
            // Populate modal
            document.getElementById('deleteCount').textContent = accountsToDelete.length;
            
            const listContainer = document.getElementById('accountsToDeleteList');
            listContainer.innerHTML = '';
            
            accountsToDelete.forEach(account => {
                const item = document.createElement('div');
                item.style.cssText = 'background: rgba(231, 76, 60, 0.1); border-left: 3px solid #e74c3c; padding: 0.75rem; margin-bottom: 0.5rem; border-radius: 4px;';
                item.innerHTML = `
                    <div style="font-weight: 600; margin-bottom: 0.25rem; color: #ecf0f1;">${account.name}</div>
                    <div style="font-size: 0.85rem; color: #bdc3c7;">
                        <span style="background: rgba(255,255,255,0.1); padding: 0.2rem 0.5rem; border-radius: 3px; margin-right: 0.5rem;">${account.id}</span>
                        <span>Status: ${account.status}</span> ‚Ä¢ 
                        <span>Platform: ${account.platform}</span>
                    </div>
                `;
                listContainer.appendChild(item);
            });
            
            // Reset input
            document.getElementById('deleteConfirmInput').value = '';
            document.getElementById('deleteInputError').style.display = 'none';
            
            // Show modal
            document.getElementById('deleteAccountsModal').style.display = 'flex';
            document.getElementById('deleteAccountsOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeDeleteModal() {
            document.getElementById('deleteAccountsModal').style.display = 'none';
            document.getElementById('deleteAccountsOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
            document.getElementById('deleteConfirmInput').value = '';
            document.getElementById('deleteInputError').style.display = 'none';
        }

        function confirmDeleteAccounts() {
            const input = document.getElementById('deleteConfirmInput').value;
            const errorMsg = document.getElementById('deleteInputError');
            
            if (input !== 'DELETE') {
                errorMsg.style.display = 'block';
                document.getElementById('deleteConfirmInput').style.borderColor = '#e74c3c';
                return;
            }
            
            // Store deleted accounts data for undo
            window.deletedAccountsBackup = {
                accounts: {},
                profiles: {},
                rows: []
            };
            
            // Collect data before deletion
            window.accountIdsToDelete.forEach(id => {
                // Store account data
                window.deletedAccountsBackup.accounts[id] = {...accountsData[id]};
                window.deletedAccountsBackup.profiles[id] = {...accountProfiles[id]};
                
                // Store row HTML
                const row = document.querySelector(`tr[data-account-id="${id}"]`);
                if (row) {
                    window.deletedAccountsBackup.rows.push({
                        id: id,
                        html: row.outerHTML,
                        index: Array.from(row.parentNode.children).indexOf(row)
                    });
                }
            });
            
            // Perform deletion (hide rows, don't remove yet)
            window.accountIdsToDelete.forEach(id => {
                const row = document.querySelector(`tr[data-account-id="${id}"]`);
                if (row) {
                    row.style.display = 'none';
                    row.setAttribute('data-pending-delete', 'true');
                }
            });
            
            // Reset checkboxes
            document.getElementById('selectAllAccounts').checked = false;
            updateDeleteButton();
            
            // Close modal
            closeDeleteModal();
            
            // Show undo toast
            showUndoToast(window.accountsToDelete.length);
        }
        
        let undoTimer = null;
        let undoTimeoutDuration = 6000; // 6 seconds
        
        function showUndoToast(count) {
            const toast = document.getElementById('undoToast');
            const countSpan = document.getElementById('undoCount');
            const progressBar = document.getElementById('undoProgress');
            
            countSpan.textContent = count;
            toast.style.display = 'flex';
            
            // Reset progress bar
            progressBar.style.width = '100%';
            progressBar.style.transition = 'none';
            
            // Start countdown animation
            setTimeout(() => {
                progressBar.style.transition = `width ${undoTimeoutDuration}ms linear`;
                progressBar.style.width = '0%';
            }, 50);
            
            // Clear any existing timer
            if (undoTimer) {
                clearTimeout(undoTimer);
            }
            
            // Set timer for permanent deletion
            undoTimer = setTimeout(() => {
                permanentlyDeleteAccounts();
                hideUndoToast();
            }, undoTimeoutDuration);
        }
        
        function hideUndoToast() {
            const toast = document.getElementById('undoToast');
            toast.style.display = 'none';
        }
        
        function undoDelete() {
            // Clear the timer
            if (undoTimer) {
                clearTimeout(undoTimer);
                undoTimer = null;
            }
            
            // Restore all rows
            window.accountIdsToDelete.forEach(id => {
                const row = document.querySelector(`tr[data-account-id="${id}"]`);
                if (row) {
                    row.style.display = '';
                    row.removeAttribute('data-pending-delete');
                }
            });
            
            // Clear backup data
            window.deletedAccountsBackup = null;
            window.accountIdsToDelete = [];
            window.accountsToDelete = [];
            
            // Hide toast
            hideUndoToast();
        }
        
        function permanentlyDeleteAccounts() {
            if (!window.deletedAccountsBackup) return;
            
            // Actually delete from data and DOM
            window.accountIdsToDelete.forEach(id => {
                delete accountsData[id];
                delete accountProfiles[id];
                
                // Remove from table
                const row = document.querySelector(`tr[data-account-id="${id}"]`);
                if (row) row.remove();
            });
            
            // Save to localStorage
            localStorage.setItem('accountsData', JSON.stringify(accountsData));
            localStorage.setItem('accountProfiles', JSON.stringify(accountProfiles));
            
            // Clear backup and temp data
            window.deletedAccountsBackup = null;
            window.accountIdsToDelete = [];
            window.accountsToDelete = [];
        }

        // Add event listeners to checkboxes
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('account-checkbox')) {
                updateDeleteButton();
            }
        });

        // Add checkboxes to all existing rows on page load
        window.addEventListener('DOMContentLoaded', function() {
            const rows = document.querySelectorAll('#accountsTable tr');
            rows.forEach((row, index) => {
                // Skip if already has checkbox
                if (row.querySelector('.account-checkbox')) return;
                
                // Get account ID from data attribute or from the ID column
                let accountId = row.getAttribute('data-account-id');
                if (!accountId) {
                    const idCell = row.querySelector('td:first-child');
                    if (idCell) {
                        accountId = idCell.textContent.trim();
                        row.setAttribute('data-account-id', accountId);
                    }
                }
                
                // Add checkbox as first cell
                const checkboxCell = document.createElement('td');
                checkboxCell.innerHTML = `<input type="checkbox" class="account-checkbox" value="${accountId}">`;
                row.insertBefore(checkboxCell, row.firstChild);
            });
        });
    </script>

    <!-- Global Sidebar Script -->
    <script src="../js/sidebar.js"></script>
    
    <script>
        // Toggle Visibility Function
        function toggleVisibility(element) {
            const isVisible = element.getAttribute('data-visible') === 'true';
            
            if (isVisible) {
                element.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è'; // Eye with slash (hidden)
                element.setAttribute('data-visible', 'false');
                element.style.opacity = '0.5';
            } else {
                element.textContent = 'üëÅÔ∏è'; // Eye (visible)
                element.setAttribute('data-visible', 'true');
                element.style.opacity = '1';
            }
        }

        // Copy 2FA Code Function
        function copy2FACode(element) {
            const code = element.textContent.trim();
            
            // Copy to clipboard
            navigator.clipboard.writeText(code).then(() => {
                // Visual feedback
                const originalBg = element.style.background;
                const originalText = element.textContent;
                
                element.style.background = '#2ecc71';
                element.style.color = 'white';
                element.textContent = '‚úì Copied!';
                
                setTimeout(() => {
                    element.style.background = originalBg;
                    element.style.color = '#3498db';
                    element.textContent = originalText;
                }, 1500);
            }).catch(err => {
                console.error('Failed to copy:', err);
                alert('Failed to copy code');
            });
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('moreFiltersDropdown');
            const wrapper = document.querySelector('.more-filters-wrapper');
            
            if (dropdown && wrapper && !wrapper.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });
    </script>
</body>
</html>

<!-- Delete Accounts Modal -->
<div class="modal" id="deleteAccountsModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: none; align-items: center; justify-content: center; z-index: 10000; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px);">
    <div class="modal-content" style="position: relative; background: #2c3e50; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); max-width: 600px; width: 90%; max-height: 85vh; overflow-y: auto; padding: 0;">
        <div class="modal-header" style="padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center;">
            <h2 style="color: #e74c3c; margin: 0; font-size: 1.3rem;">‚ö†Ô∏è Delete Accounts</h2>
            <button class="close-btn" onclick="closeDeleteModal()" style="background: none; border: none; font-size: 1.8rem; color: #bbb; cursor: pointer; line-height: 1; padding: 0; width: 30px; height: 30px;">&times;</button>
        </div>

        <div style="padding: 1.5rem;">
            <div style="background: rgba(255, 193, 7, 0.15); border: 1px solid rgba(255, 193, 7, 0.4); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                <p style="margin: 0; color: #ffc107; font-size: 0.9rem;">
                    <strong>Warning:</strong> You are about to delete <span id="deleteCount" style="font-weight: 700;">0</span> account(s). You will have a few seconds to undo.
                </p>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: #ecf0f1;">Accounts to be deleted:</h3>
                <div id="accountsToDeleteList" style="max-height: 250px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 0.5rem; background: rgba(0,0,0,0.2);">
                </div>
            </div>

            <div style="background: rgba(0,0,0,0.2); border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: #ecf0f1;">
                    Type <span style="color: #e74c3c; font-family: monospace; background: rgba(255,255,255,0.1); padding: 0.2rem 0.5rem; border-radius: 4px;">DELETE</span> to confirm:
                </label>
                <input type="text" id="deleteConfirmInput" placeholder="Type DELETE here" style="width: 100%; padding: 0.75rem; border: 2px solid rgba(255,255,255,0.2); border-radius: 6px; font-size: 1rem; font-family: monospace; background: rgba(0,0,0,0.3); color: white;">
                <p id="deleteInputError" style="color: #e74c3c; font-size: 0.85rem; margin: 0.5rem 0 0 0; display: none;">
                    ‚ùå You must type "DELETE" exactly to proceed
                </p>
            </div>

            <div style="display: flex; gap: 1rem;">
                <button class="btn" onclick="closeDeleteModal()" style="flex: 1; background: #95a5a6; color: white; padding: 0.875rem; font-size: 1rem; border: none; border-radius: 8px; cursor: pointer;">
                    Cancel
                </button>
                <button class="btn" onclick="confirmDeleteAccounts()" style="flex: 1; background: #e74c3c; color: white; padding: 0.875rem; font-size: 1rem; font-weight: 600; border: none; border-radius: 8px; cursor: pointer;">
                    üóëÔ∏è Delete Accounts
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Undo Toast Notification -->
<div id="undoToast" style="position: fixed; bottom: 2rem; right: 2rem; background: #34495e; color: white; padding: 1rem 1.5rem; border-radius: 10px; box-shadow: 0 6px 20px rgba(0,0,0,0.4); display: none; align-items: center; gap: 1rem; z-index: 10001; min-width: 320px;">
    <span id="undoMessage" style="font-size: 0.95rem; flex: 1;">Deleted <strong id="undoCount">0</strong> account(s)</span>
    <button onclick="undoDelete()" style="background: #3498db; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem; transition: background 0.2s;">
        ‚Ü∂ UNDO
    </button>
    <div id="undoProgress" style="position: absolute; bottom: 0; left: 0; height: 4px; background: #3498db; width: 100%; border-radius: 0 0 10px 10px;"></div>
</div>

<!-- Login Details Popup -->
<div id="loginDetailsOverlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(3px); display: none; z-index: 10002; align-items: center; justify-content: center;" onclick="closeLoginDetails()"></div>
<div id="loginDetailsPopup" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); padding: 1.5rem; min-width: 350px; max-width: 450px; display: none; z-index: 10003;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; border-bottom: 2px solid #e5e5e5; padding-bottom: 1rem;">
        <h3 style="margin: 0; color: #2c3e50; font-size: 1.2rem;">üîë Login Details</h3>
        <button onclick="closeLoginDetails()" style="background: none; border: none; font-size: 1.5rem; color: #999; cursor: pointer; padding: 0; width: 30px; height: 30px; line-height: 1;">&times;</button>
    </div>
    
    <div style="margin-bottom: 1rem;">
        <label style="display: block; font-weight: 600; color: #555; margin-bottom: 0.5rem; font-size: 0.9rem;">Profile Name</label>
        <div id="loginProfileName" style="padding: 0.75rem; background: #f8f9fa; border-radius: 6px; font-weight: 600; color: #2c3e50;">Main Profile</div>
    </div>
    
    <div style="margin-bottom: 1rem;">
        <label style="display: block; font-weight: 600; color: #555; margin-bottom: 0.5rem; font-size: 0.9rem;">Email</label>
        <div style="display: flex; gap: 0.5rem; align-items: center;">
            <input type="text" id="loginEmail" readonly value="email@example.com" style="flex: 1; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px; background: #f8f9fa; font-family: monospace;">
            <button onclick="copyToClipboard('loginEmail')" style="background: #3498db; color: white; border: none; padding: 0.75rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.9rem;" title="Copy email">
                üìã
            </button>
        </div>
    </div>
    
    <div style="margin-bottom: 1.5rem;">
        <label style="display: block; font-weight: 600; color: #555; margin-bottom: 0.5rem; font-size: 0.9rem;">Password</label>
        <div style="display: flex; gap: 0.5rem; align-items: center;">
            <input type="text" id="loginPassword" readonly value="password123" style="flex: 1; padding: 0.75rem; border: 1px solid #ddd; border-radius: 6px; background: #f8f9fa; font-family: monospace;">
            <button onclick="copyToClipboard('loginPassword')" style="background: #3498db; color: white; border: none; padding: 0.75rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.9rem;" title="Copy password">
                üìã
            </button>
        </div>
    </div>
    
    <button onclick="closeLoginDetails()" style="width: 100%; background: #2c3e50; color: white; border: none; padding: 0.875rem; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1rem;">
        Close
    </button>
</div>
    <button onclick="undoDelete()" style="background: #3498db; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem; transition: background 0.2s;">
        ‚Ü∂ UNDO
    </button>
    <div id="undoProgress" style="position: absolute; bottom: 0; left: 0; height: 4px; background: #3498db; width: 100%; border-radius: 0 0 10px 10px;"></div>
</div>

<style>
@keyframes slideIn {
    from {
        transform: translateX(400px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

#undoToast button:hover {
    background: #2980b9;
}
</style>
