<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard</title>

  <link rel="stylesheet" href="../css/layout.css">
  <link rel="stylesheet" href="../css/dashboard.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/admin-dashboard.css">
  
  <!-- Google Charts -->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<body>
  <div class="layout">
    <aside class="sidebar" id="sidebar"></aside>

    <header class="header">
      <div>
        <h1>üìä Dashboard</h1>
      </div>
      <div class="header-right">
        <div class="user-info">
          <span>Admin User</span>
          <div class="user-avatar">AU</div>
        </div>
      </div>
    </header>

    <main class="main">
      <div class="dash-grid">
        
        <!-- KPI Cards -->
        <div class="kpi-row">
          <div class="kpi-card blue">
            <div class="kpi-label">Main Wallet</div>
            <div class="kpi-value" id="kpiMainWallet">$2,450.00</div>
            <div class="kpi-sub">Available balance</div>
          </div>

          <div class="kpi-card green">
            <div class="kpi-label">Total Topups</div>
            <div class="kpi-value" id="kpiTopups">$4,500.00</div>
            <div class="kpi-sub">All time deposits</div>
          </div>

          <div class="kpi-card amber">
            <div class="kpi-label">Platform Spend</div>
            <div class="kpi-value" id="kpiSpend">$3,211.25</div>
            <div class="kpi-sub">Allocated to platforms</div>
          </div>

          <div class="kpi-card violet">
            <div class="kpi-label">Total Fees</div>
            <div class="kpi-value" id="kpiFees">$125.00</div>
            <div class="kpi-sub">Collected fees</div>
          </div>
        </div>

        <!-- Content Row -->
        <div class="content-row">
          <!-- Pending Clients -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Pending Clients</h2>
              <div class="card-subtitle">Awaiting approval</div>
            </div>
            <div class="card-body" style="padding: 0;">
              <table>
                <thead>
                  <tr>
                    <th>Client</th>
                    <th>Registered</th>
                    <th>Type</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="pendingClientsTable">
                  <tr>
                    <td>
                      <div class="name">John D.</div>
                      <div class="email">john@example.com</div>
                    </td>
                    <td>2 days ago</td>
                    <td>
                      <span class="badge pending">
                        <span class="dot"></span>
                        Client
                      </span>
                    </td>
                    <td>
                      <div style="display: flex; gap: 8px;">
                        <button class="action-btn approve" onclick="alert('Approved: John D.')">‚úì Approve</button>
                        <button class="action-btn reject" onclick="alert('Rejected: John D.')">‚úó Reject</button>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Sarah K.</div>
                      <div class="email">sarah@example.com</div>
                    </td>
                    <td>3 days ago</td>
                    <td>
                      <span class="badge pending">
                        <span class="dot"></span>
                        Employee
                      </span>
                    </td>
                    <td>
                      <div style="display: flex; gap: 8px;">
                        <button class="action-btn approve" onclick="alert('Approved: Sarah K.')">‚úì Approve</button>
                        <button class="action-btn reject" onclick="alert('Rejected: Sarah K.')">‚úó Reject</button>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Mike R.</div>
                      <div class="email">mike@example.com</div>
                    </td>
                    <td>5 days ago</td>
                    <td>
                      <span class="badge pending">
                        <span class="dot"></span>
                        Client
                      </span>
                    </td>
                    <td>
                      <div style="display: flex; gap: 8px;">
                        <button class="action-btn approve" onclick="alert('Approved: Mike R.')">‚úì Approve</button>
                        <button class="action-btn reject" onclick="alert('Rejected: Mike R.')">‚úó Reject</button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Pending Topups -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Pending Topups</h2>
              <div class="card-subtitle">Awaiting approval</div>
            </div>
            <div class="card-body">
              <div class="topup-list" id="topupList">
                <div class="topup-item">
                  <div class="topup-info">
                    <div class="topup-client">Alex M.</div>
                    <div class="topup-details">Wire ‚Ä¢ Today</div>
                  </div>
                  <div class="topup-amount">$1,500.00</div>
                </div>
                <div class="topup-item">
                  <div class="topup-info">
                    <div class="topup-client">Maria P.</div>
                    <div class="topup-details">Wire ‚Ä¢ Today</div>
                  </div>
                  <div class="topup-amount">$1,200.00</div>
                </div>
                <div class="topup-item">
                  <div class="topup-info">
                    <div class="topup-client">John D.</div>
                    <div class="topup-details">Crypto USDT ‚Ä¢ Yesterday</div>
                  </div>
                  <div class="topup-amount">$1,000.00</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Second Row -->
        <div class="content-row">
          <!-- Fee Breakdown -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Fee Breakdown</h2>
              <div class="card-subtitle">Revenue by fee type</div>
            </div>
            <div class="card-body">
              <div class="fee-breakdown">
                <div id="feeChart"></div>
              </div>
            </div>
          </div>

          <!-- Top Clients Last Month -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Top Clients Last Month</h2>
              <div class="card-subtitle">Highest charges in previous month</div>
            </div>
            <div class="card-body" style="padding: 0;">
              <table>
                <thead>
                  <tr>
                    <th>Rank</th>
                    <th>Client</th>
                    <th style="text-align: right;">Total Charges</th>
                  </tr>
                </thead>
                <tbody id="topClientsTable">
                  <tr>
                    <td style="font-size: 18px; font-weight: 700;">ü•á</td>
                    <td>
                      <div class="name">Alex M.</div>
                      <div class="email">alex@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$1,250.00</td>
                  </tr>
                  <tr>
                    <td style="font-size: 18px; font-weight: 700;">ü•à</td>
                    <td>
                      <div class="name">Maria P.</div>
                      <div class="email">maria@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$980.50</td>
                  </tr>
                  <tr>
                    <td style="font-size: 18px; font-weight: 700;">ü•â</td>
                    <td>
                      <div class="name">John D.</div>
                      <div class="email">john@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$750.00</td>
                  </tr>
                  <tr>
                    <td style="font-size: 18px; font-weight: 700;">4</td>
                    <td>
                      <div class="name">Sarah K.</div>
                      <div class="email">sarah@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$620.75</td>
                  </tr>
                  <tr>
                    <td style="font-size: 18px; font-weight: 700;">5</td>
                    <td>
                      <div class="name">Mike R.</div>
                      <div class="email">mike@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$450.00</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Third Row -->
        <div class="content-row">
          <!-- Accounts Overview -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">üì± Accounts Overview</h2>
              <div class="card-subtitle">Distribution across platforms</div>
            </div>
            <div class="card-body">
              <div style="display: grid; grid-template-columns: 1fr 1.2fr; gap: 24px; align-items: center;">
                <!-- Donut Chart -->
                <div>
                  <div id="accountsChart" style="height: 250px;"></div>
                </div>
                
                <!-- Platform Breakdown -->
                <div class="platform-accounts">
                  <div class="platform-account-item">
                    <div class="platform-account-header">
                      <span class="platform-account-icon">üìò</span>
                      <span class="platform-account-name">Facebook</span>
                      <span class="platform-account-count">100</span>
                    </div>
                    <div class="platform-account-bar">
                      <div class="platform-account-fill assigned" style="width: 80%;" data-tooltip="80 Assigned"></div>
                      <div class="platform-account-fill unassigned" style="width: 20%;" data-tooltip="20 Unassigned"></div>
                    </div>
                    <div class="platform-account-stats">
                      <span class="stat-assigned">‚úì 80 Assigned</span>
                      <span class="stat-unassigned">‚óã 20 Available</span>
                    </div>
                  </div>

                  <div class="platform-account-item">
                    <div class="platform-account-header">
                      <span class="platform-account-icon">üîç</span>
                      <span class="platform-account-name">Google</span>
                      <span class="platform-account-count">50</span>
                    </div>
                    <div class="platform-account-bar">
                      <div class="platform-account-fill assigned" style="width: 90%;"></div>
                      <div class="platform-account-fill unassigned" style="width: 10%;"></div>
                    </div>
                    <div class="platform-account-stats">
                      <span class="stat-assigned">‚úì 45 Assigned</span>
                      <span class="stat-unassigned">‚óã 5 Available</span>
                    </div>
                  </div>

                  <div class="platform-account-item">
                    <div class="platform-account-header">
                      <span class="platform-account-icon">üéµ</span>
                      <span class="platform-account-name">TikTok</span>
                      <span class="platform-account-count">50</span>
                    </div>
                    <div class="platform-account-bar">
                      <div class="platform-account-fill assigned" style="width: 60%;"></div>
                      <div class="platform-account-fill unassigned" style="width: 40%;"></div>
                    </div>
                    <div class="platform-account-stats">
                      <span class="stat-assigned">‚úì 30 Assigned</span>
                      <span class="stat-unassigned">‚óã 20 Available</span>
                    </div>
                  </div>

                  <div class="platform-account-item">
                    <div class="platform-account-header">
                      <span class="platform-account-icon">üì∑</span>
                      <span class="platform-account-name">Instagram</span>
                      <span class="platform-account-count">50</span>
                    </div>
                    <div class="platform-account-bar">
                      <div class="platform-account-fill assigned" style="width: 30%;"></div>
                      <div class="platform-account-fill unassigned" style="width: 70%;"></div>
                    </div>
                    <div class="platform-account-stats">
                      <span class="stat-assigned">‚úì 15 Assigned</span>
                      <span class="stat-unassigned">‚óã 35 Available</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Low Balance Alerts -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">‚ö†Ô∏è Low Balance Alerts</h2>
              <div class="card-subtitle">Clients with main wallet below threshold</div>
            </div>
            <div class="card-body" style="padding: 0;">
              <table>
                <thead>
                  <tr>
                    <th>Client</th>
                    <th style="text-align: right;">Main Wallet</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="lowBalanceTable">
                  <tr>
                    <td>
                      <div class="name">Tom B.</div>
                      <div class="email">tom@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--red);">$15.00</td>
                    <td><span class="badge suspended"><span class="dot"></span>Critical</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Emily R.</div>
                      <div class="email">emily@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--red);">$45.00</td>
                    <td><span class="badge suspended"><span class="dot"></span>Critical</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Anna K.</div>
                      <div class="email">anna@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$65.25</td>
                    <td><span class="badge pending"><span class="dot"></span>Low</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">David L.</div>
                      <div class="email">david@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$78.50</td>
                    <td><span class="badge pending"><span class="dot"></span>Low</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Lisa M.</div>
                      <div class="email">lisa@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$92.00</td>
                    <td><span class="badge pending"><span class="dot"></span>Low</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Fourth Row -->
        <div class="content-row">
          <!-- Low Balance Alerts -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">‚ö†Ô∏è Low Balance Alerts</h2>
              <div class="card-subtitle">Clients with main wallet below threshold</div>
            </div>
            <div class="card-body" style="padding: 0;">
              <table>
                <thead>
                  <tr>
                    <th>Client</th>
                    <th style="text-align: right;">Main Wallet</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="lowBalanceTable">
                  <tr>
                    <td>
                      <div class="name">Tom B.</div>
                      <div class="email">tom@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--red);">$15.00</td>
                    <td><span class="badge suspended"><span class="dot"></span>Critical</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Emily R.</div>
                      <div class="email">emily@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--red);">$45.00</td>
                    <td><span class="badge suspended"><span class="dot"></span>Critical</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Anna K.</div>
                      <div class="email">anna@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$65.25</td>
                    <td><span class="badge pending"><span class="dot"></span>Low</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">David L.</div>
                      <div class="email">david@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$78.50</td>
                    <td><span class="badge pending"><span class="dot"></span>Low</span></td>
                  </tr>
                  <tr>
                    <td>
                      <div class="name">Lisa M.</div>
                      <div class="email">lisa@example.com</div>
                    </td>
                    <td style="text-align: right; font-weight: 700; color: var(--amber);">$92.00</td>
                    <td><span class="badge pending"><span class="dot"></span>Low</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Most Requested Marketplace Items -->
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">üî• Most Requested Items</h2>
              <div class="card-subtitle">Top 3 marketplace requests this month</div>
            </div>
            <div class="card-body">
              <div id="hotItemsList" style="display: flex; flex-direction: column; gap: 12px;">
                <div class="hot-item">
                  <div class="hot-item-rank">ü•á</div>
                  <div class="hot-item-icon">üìò</div>
                  <div class="hot-item-info">
                    <div class="hot-item-name">Facebook Account + BM</div>
                    <div class="hot-item-subtitle">3 Ad Acc ‚Ä¢ $250 Limit</div>
                  </div>
                  <div class="hot-item-stats">
                    <div class="hot-item-requests">24</div>
                    <span class="hot-item-trend up">‚Üó Trending</span>
                  </div>
                </div>
                <div class="hot-item">
                  <div class="hot-item-rank">ü•à</div>
                  <div class="hot-item-icon">üéµ</div>
                  <div class="hot-item-info">
                    <div class="hot-item-name">Premium TikTok Ads</div>
                    <div class="hot-item-subtitle">No Spending Limits</div>
                  </div>
                  <div class="hot-item-stats">
                    <div class="hot-item-requests">18</div>
                    <span class="hot-item-trend up">‚Üó Trending</span>
                  </div>
                </div>
                <div class="hot-item">
                  <div class="hot-item-rank">ü•â</div>
                  <div class="hot-item-icon">G</div>
                  <div class="hot-item-info">
                    <div class="hot-item-name">Google Agency</div>
                    <div class="hot-item-subtitle">Premium Tier</div>
                  </div>
                  <div class="hot-item-stats">
                    <div class="hot-item-requests">15</div>
                    <span class="hot-item-trend stable">‚Üí Stable</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </main>
  </div>

  <script src="../js/sidebar.js"></script>
  <script>
    // Demo data matching finance page structure
    const LS_KEY = "admin_finance_demo_v7";

    const pendingClients = [
      { name: "John D.", email: "john@example.com", registered: "2 days ago", type: "Client" },
      { name: "Sarah K.", email: "sarah@example.com", registered: "3 days ago", type: "Employee" },
      { name: "Mike R.", email: "mike@example.com", registered: "5 days ago", type: "Client" }
    ];

    const clients = [
      { id: "100", name: "Alex M.", email: "alex@example.com", role: "Client", status: "active", balance: 2450.00 },
      { id: "101", name: "Maria P.", email: "maria@example.com", role: "Client", status: "active", balance: 1890.50 },
      { id: "102", name: "John D.", email: "john@example.com", role: "Client", status: "pending", balance: 0 },
      { id: "103", name: "Sarah K.", email: "sarah@example.com", role: "Employee", status: "active", balance: 0 },
    ];

    const platforms = [
      { name: "Facebook", icon: "üìò", balance: 1250.00 },
      { name: "Google", icon: "üîç", balance: 890.50 },
      { name: "TikTok", icon: "üéµ", balance: 650.00 },
      { name: "Instagram", icon: "üì∑", balance: 420.75 }
    ];

    const pendingTopups = [
      { client: "Alex M.", amount: 1500.00, type: "Wire", date: "Today" },
      { client: "Maria P.", amount: 1200.00, type: "Wire", date: "Today" },
      { client: "John D.", amount: 1000.00, type: "Crypto USDT", date: "Yesterday" }
    ];

    const feeBreakdown = [
      { type: "Topup Fees", icon: "üí∞", amount: 20.00 },
      { type: "Transfer Fees", icon: "üîÑ", amount: 5.00 },
      { type: "Service Charges", icon: "‚öôÔ∏è", amount: 0.00 },
      { type: "Setup Charges", icon: "üîß", amount: 0.00 }
    ];

    const clientStatistics = {
      totalClients: 12,
      activeClients: 9,
      pendingApproval: 2,
      suspended: 1
    };

    function money(n){
      const v = Number(n || 0);
      return v.toLocaleString(undefined, { style:"currency", currency:"USD" });
    }

    function loadFinanceData(){
      const raw = localStorage.getItem(LS_KEY);
      if(!raw) return null;
      try{
        return JSON.parse(raw);
      }catch(e){
        return null;
      }
    }

    function calculateKPIs(){
      const data = loadFinanceData();
      if(!data || !data.ledger) return { mainWallet: 2450, topups: 980, spend: 700, fees: 25 };

      let mainWallet = 0;
      let topups = 0;
      let spend = 0;
      let fees = 0;

      data.ledger.forEach(tx => {
        const amt = Number(tx.amount || 0);
        
        if(tx.type === "topup") topups += amt;
        if(tx.to === "mainWallet") mainWallet += amt;
        if(tx.from === "mainWallet") mainWallet -= amt;
        if(tx.type === "transfer" && tx.from === "mainWallet") spend += amt;
        if(tx.type === "fee" || tx.category?.includes("fee")) fees += amt;
      });

      return { mainWallet, topups, spend, fees };
    }

    function renderKPIs(){
      const kpis = calculateKPIs();
      
      document.getElementById("kpiMainWallet").textContent = money(kpis.mainWallet);
      document.getElementById("kpiTopups").textContent = money(kpis.topups);
      document.getElementById("kpiSpend").textContent = money(kpis.spend);
      document.getElementById("kpiFees").textContent = money(kpis.fees);
    }

    function renderPendingClients(){
      const tbody = document.getElementById("pendingClientsTable");
      
      if(pendingClients.length === 0){
        tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 20px; color: var(--muted);">No pending clients</td></tr>';
        return;
      }
      
      tbody.innerHTML = pendingClients.map(client => `
        <tr>
          <td>
            <div class="name">${client.name}</div>
            <div class="email">${client.email}</div>
          </td>
          <td>${client.registered}</td>
          <td>
            <span class="badge pending">
              <span class="dot"></span>
              ${client.type}
            </span>
          </td>
          <td>
            <div style="display: flex; gap: 8px;">
              <button class="action-btn approve" onclick="approveClient('${client.name}')">‚úì Approve</button>
              <button class="action-btn reject" onclick="rejectClient('${client.name}')">‚úó Reject</button>
            </div>
          </td>
        </tr>
      `).join("");
    }

    function approveClient(name){
      alert(`Approved: ${name}`);
      // Here you would call your API to approve the client
    }

    function rejectClient(name){
      alert(`Rejected: ${name}`);
      // Here you would call your API to reject the client
    }

    function renderClients(){
      const tbody = document.getElementById("clientsTable");
      
      tbody.innerHTML = clients.map(client => `
        <tr>
          <td>
            <div class="name">${client.name}</div>
            <div class="email">${client.email}</div>
          </td>
          <td>${client.role}</td>
          <td>
            <span class="badge ${client.status}">
              <span class="dot"></span>
              ${client.status.charAt(0).toUpperCase() + client.status.slice(1)}
            </span>
          </td>
          <td style="font-weight: 700;">${money(client.balance)}</td>
        </tr>
      `).join("");
    }

    function renderTopups(){
      const list = document.getElementById("topupList");
      
      if(pendingTopups.length === 0){
        list.innerHTML = '<div style="text-align: center; color: var(--muted); padding: 20px;">No pending topups</div>';
        return;
      }
      
      list.innerHTML = pendingTopups.map(topup => `
        <div class="topup-item">
          <div class="topup-info">
            <div class="topup-client">${topup.client}</div>
            <div class="topup-details">${topup.type} ‚Ä¢ ${topup.date}</div>
          </div>
          <div class="topup-amount">${money(topup.amount)}</div>
        </div>
      `).join("");
    }

    // Load Google Charts
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawFeeChart);

    function drawFeeChart() {
      // Prepare data for Google Charts
      const chartData = [['Task', 'Hours per Day']];
      feeBreakdown.forEach(fee => {
        chartData.push([fee.type, fee.amount]);
      });

      const data = google.visualization.arrayToDataTable(chartData);

      const options = {
        title: 'Fee Breakdown',
        pieHole: 0.4, // Creates a Donut Chart. Does not do anything when is3D is enabled
        is3D: true, // Enables 3D view
        pieStartAngle: 100, // Rotates the chart
        sliceVisibilityThreshold: 0.02, // Hides slices smaller than 2%
        legend: {
          position: 'bottom',
          alignment: 'center',
          textStyle: {
            color: '#233238',
            fontSize: 14,
          },
        },
        colors: ['#8AD1C2', '#9F8AD1', '#D18A99', '#BCD18A', '#D1C28A'],
      };

      const chart = new google.visualization.PieChart(document.getElementById('feeChart'));
      chart.draw(data, options);
    }

    // Redraw chart on window resize
    window.addEventListener('resize', () => {
      if (typeof google !== 'undefined' && google.visualization) {
        drawFeeChart();
      }
    });

    function renderClientStats(){
      const container = document.getElementById("clientStats");
      const total = clientStatistics.totalClients;
      
      container.innerHTML = `
        <div class="stat-item">
          <div>
            <div class="stat-label">Total Clients</div>
            <div class="stat-bar">
              <div class="stat-bar-fill" style="width: 100%;"></div>
            </div>
          </div>
          <div class="stat-value">${clientStatistics.totalClients}</div>
        </div>
        
        <div class="stat-item">
          <div>
            <div class="stat-label">Active Clients</div>
            <div class="stat-bar">
              <div class="stat-bar-fill green" style="width: ${(clientStatistics.activeClients / total * 100).toFixed(0)}%;"></div>
            </div>
          </div>
          <div class="stat-value">${clientStatistics.activeClients}</div>
        </div>
        
        <div class="stat-item">
          <div>
            <div class="stat-label">Pending Approval</div>
            <div class="stat-bar">
              <div class="stat-bar-fill amber" style="width: ${(clientStatistics.pendingApproval / total * 100).toFixed(0)}%;"></div>
            </div>
          </div>
          <div class="stat-value">${clientStatistics.pendingApproval}</div>
        </div>
        
        <div class="stat-item">
          <div>
            <div class="stat-label">Suspended</div>
            <div class="stat-bar">
              <div class="stat-bar-fill red" style="width: ${(clientStatistics.suspended / total * 100).toFixed(0)}%;"></div>
            </div>
          </div>
          <div class="stat-value">${clientStatistics.suspended}</div>
        </div>
      `;
    }

    function renderPlatforms(){
      const container = document.getElementById("platformStats");
      
      container.innerHTML = platforms.map(platform => `
        <div class="platform-item">
          <div class="platform-info">
            <span class="platform-icon">${platform.icon}</span>
            <span class="platform-name">${platform.name}</span>
          </div>
          <div class="platform-balance">${money(platform.balance)}</div>
        </div>
      `).join("");
    }

    // Initialize dashboard
    document.addEventListener("DOMContentLoaded", function(){
      renderKPIs();
      renderPendingClients();
      renderTopups();
      // Fee chart is drawn by Google Charts callback
      renderClientStats();
      renderPlatforms();
    });

  </script>

</body>
</html>
